(function(e){function t(t){for(var r,c,i=t[0],s=t[1],l=t[2],p=0,d=[];p<i.length;p++)c=i[p],Object.prototype.hasOwnProperty.call(o,c)&&o[c]&&d.push(o[c][0]),o[c]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);u&&u(t);while(d.length)d.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,i=1;i<n.length;i++){var s=n[i];0!==o[s]&&(r=!1)}r&&(a.splice(t--,1),e=c(c.s=n[0]))}return e}var r={},o={app:0},a=[];function c(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=r,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)c.d(n,r,function(t){return e[t]}.bind(null,r));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/hive.js/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],s=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var u=s;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23"),o=n("3665"),a=n("c61c"),c=(n("0488"),{mounted:function(e){e.scrollTo(0,e.scrollHeight),e.dataset.urAutoscrollEnabled=!0;var t=document.createElement("div");t.dataset.urAutoscrollTarget="",e.appendChild(t),e.addEventListener("scroll",(function(){var t=e.scrollHeight,n=e.scrollTop,r=e.clientHeight;t===n+r?e.dataset.urAutoscrollEnabled=!0:delete e.dataset.urAutoscrollEnabled}))},updated:function(e){var t;e.dataset.urAutoscrollEnabled&&(null===(t=e.lastElementChild)||void 0===t||t.scrollIntoView({block:"end",behavior:"smooth"}))}}),i=n("f3cb"),s={key:0,class:"ur-chat-error"},l=Object(r["g"])("i",{class:"fa fa-comment"},null,-1),u={key:2,class:"ur-chat-widget"},p={class:"flex flex-col h-full"},d={class:"menu-bar"};function h(e,t,n,o,a,c){var i=Object(r["w"])("chat-box");return c.error?(Object(r["q"])(),Object(r["d"])("div",s,[Object(r["g"])("i",{class:a.css.icon("exclamation-triangle"),title:c.error},null,10,["title"])])):c.collapsed?(Object(r["q"])(),Object(r["d"])("div",{key:1,class:"ur-chat-collapsed",onClick:t[1]||(t[1]=function(){return c.toggle&&c.toggle.apply(c,arguments)})},[l])):(Object(r["q"])(),Object(r["d"])("div",u,[Object(r["g"])("div",p,[Object(r["g"])("div",d,[Object(r["g"])("i",{class:a.css.icon("minus cursor-pointer mx-1"),onClick:t[2]||(t[2]=function(){return c.toggle&&c.toggle.apply(c,arguments)})},null,2)]),Object(r["g"])(i,{room_id:n.room_id},null,8,["room_id"])])]))}n("a9e3");var f=n("82c1"),b=n.n(f),m=(n("99af"),{key:0,class:"ur-chat-box"}),v={key:0},g=Object(r["g"])("i",{class:"fa fa-exclamation-triangle text-red-700 mr-2"},null,-1),y=Object(r["f"])(" Unable to connect to server "),_=Object(r["g"])("br",null,null,-1),O=Object(r["g"])("div",{class:"flex-grow"},null,-1),w={class:"message-list"};function j(e,t,n,o,a,c){var i=Object(r["x"])("autoscroll");return c.room?(Object(r["q"])(),Object(r["d"])("div",m,[c.room.disconnected?(Object(r["q"])(),Object(r["d"])("div",v,[g,y,_,Object(r["f"])(" Will retry every 5 seconds ("+Object(r["A"])(c.room.reconnect_tries||0)+" tries) ",1)])):Object(r["e"])("",!0),Object(r["g"])("div",null,"Players: "+Object(r["A"])(c.room.state.user_ids.length),1),O,Object(r["G"])(Object(r["g"])("div",w,[(Object(r["q"])(!0),Object(r["d"])(r["a"],null,Object(r["u"])(c.room.messages,(function(e,t){return Object(r["q"])(),Object(r["d"])("p",{key:t},Object(r["A"])("".concat(e.username,": ").concat(e.text)),1)})),128))],512),[[i]]),Object(r["g"])("form",{onSubmit:t[3]||(t[3]=function(){return c.submit&&c.submit.apply(c,arguments)}),class:"text-box"},[Object(r["G"])(Object(r["g"])("textarea",{"onUpdate:modelValue":t[1]||(t[1]=function(e){return a.value=e}),class:"input",ref:"textarea",onKeypress:t[2]||(t[2]=function(){return c.onKeyPress&&c.onKeyPress.apply(c,arguments)})},null,544),[[r["C"],a.value]]),Object(r["g"])("button",{type:"submit",class:a.css.icon("send")},null,2)],32)])):Object(r["e"])("",!0)}var k={props:{room_id:Number},data:function(){return{css:b.a,value:""}},computed:{room:function(){return this.$store.room.watch(this.room_id)}},methods:{submit:function(e){e.preventDefault();var t=this.value;this.$store.room.send(this.room_id,"chat",t),this.value="",this.$refs.textarea.focus()},onKeyPress:function(e){"Enter"===e.key&&!e.shiftKey&&this.submit(e)}}};k.render=j;var x=k,q={components:{ChatBox:x},props:{room_id:Number},data:function(){return{css:b.a}},computed:{collapsed:function(){return this.$store.config.state.chat_collapsed},room:function(){return window.ROOM=this.$store.room.watch(this.room_id)},error:function(){var e=this.room||{},t=e.error;return t&&"Unable to connect to server. Offline play only. Error was: ".concat(t)}},methods:{onKeyPress:function(e){"Enter"===e.key&&!e.shiftKey&&this.submit(e)},toggle:function(){this.$store.config.save({chat_collapsed:!this.collapsed})}}};q.render=h;var E,C=q,T={install:function(e,t){e.component("UrChatWidget",C)}},H=n("3835"),A=(n("159b"),n("4fad"),n("3e81")),I={show_help:!0,theme:"classic",darkmode:!0,hex_angle:"flat",zoom:"0",chat_collapsed:!1},W={type:"object",required:["theme"],properties:{darkmode:{title:"Dark Mode",type:"boolean"},theme:{title:"Theme",type:"string",enum:["classic","carbon"]},debug:{title:"Show space numbers",type:"boolean"},show_help:{type:"boolean",title:"Show Help",default:!0},hex_angle:{type:"string",title:"Hex Angle",enum:["flat","pointy"]},zoom:{type:"integer",title:"Zoom"}}},P=function(){var e=Object(A["a"])({LS_KEY:"config",initial:I});e.schema=W;var t=e.state,n=e.save,r=function(e){n(e);var r=t.darkmode;document.body.classList[r?"add":"remove"]("theme-dark_mode")};return e.form={schema:W,state:t,onChange:r},document.body.classList[t.darkmode?"add":"remove"]("theme-dark_mode"),e},S=(n("7db0"),n("b64b"),n("73ba")),$=n.n(S),N=n("2909"),M=n("2ef0"),F=n("6c02"),G=(n("caad"),n("2532"),n("cb29"),n("ac1f"),n("5319"),n("d81d"),n("1276"),n("4d26")),R=n.n(G),L=Object(r["s"])([]),U=100,z=U*Math.sqrt(3)/10,D={white2:"#FCFBF7",black2:"#333",yellow:"#F1C40F",green:"#4a4",red:"#a44",purple:"#84f",blue:"#4af",white:"#F6F3E7",black:"#000",gray:"gray"},J="rgba(0, 0, 0, 0)",K=128,B=96,Y={empty:"rgba(".concat(K,",").concat(K,",").concat(K,",0.5)"),empty_r:"rgba(".concat(K,",").concat(B,",").concat(B,",0.5)"),empty_g:"rgba(".concat(B,",").concat(K,",").concat(B,",0.5)"),empty_b:"rgba(".concat(B,",").concat(B,",").concat(K,",0.5)"),player_1:D.white2,player_2:D.black2},V=function(e,t,n,r,o){e.beginPath(),e.moveTo(n+o*Math.cos(0),r+o*Math.sin(0));for(var a=2*Math.PI/6,c=0;c<7;c++)e.lineTo(n+o*Math.cos(c*a),r+o*Math.sin(c*a));t.includes("rgba")&&(e.globalCompositeOperation="destination-out",e.fill(),e.globalCompositeOperation="source-over"),e.fillStyle=t,e.fill()},Z={thick:"white,black,red,blue,purple,yellow,gray,green",thin:"purple",dashed:"blue"},Q=1-.05*Math.sqrt(3),X={thin:Q,thick:1-.1*Math.sqrt(3),dashed:Q},ee=function(e,t){var n="background-image: url(".concat(t.toDataURL(),")");return L.push("debug ".concat(e)),".".concat(e.replace(/ /g,".")," { ").concat(n," }\n")},te=function(e){if(e&&(E=null),!E){var t={},n=function(n){var o=document.createElement("canvas");o.width=r.width,o.height=r.height,o.getContext("2d").drawImage(r,0,0),null===e||void 0===e||e.appendChild(o),t[n]=o},r=document.createElement("canvas"),o="";null===e||void 0===e||e.appendChild(r),r.width=2*U,r.height=Math.sqrt(3)*U;var a=r.getContext("2d");Object.entries(Z).map((function(e){var t=Object(H["a"])(e,2),o=t[0],c=t[1];c.split(",").forEach((function(e){if(a.clearRect(0,0,2*U,2*U),V(a,D[e],r.width/2,r.height/2,U),X[o]&&V(a,J,r.width/2,r.height/2,U*X[o]),"dashed"===o){for(var t=0;t<6;t++){var c=r.width/4;a.translate(r.width/2,r.height/2),a.rotate(Math.PI/3),a.translate(-r.width/2,-r.height/2),a.clearRect(r.width/2-c/2,-1,c,z,0)}a.restore()}n(o+","+e)}))}));var c={player_1:t["thick,white"],player_2:t["thick,black"]},i=[void 0,"green","red","purple","gray","yellow","blue","blue-dashed"];Object.entries(Y).forEach((function(e){var n=Object(H["a"])(e,2),s=n[0],l=n[1];return i.forEach((function(e){a.clearRect(0,0,r.width,r.height),V(a,l,r.width/2,r.height/2,U);var n=R()("hex","hex-"+s,e),i=c[s];if(i&&a.drawImage(i,0,0),e){var u=e.split("-"),p=Object(H["a"])(u,2),d=p[0],h=p[1],f=void 0===h?"thick":h;a.drawImage(t[f+","+d],0,0)}o+=ee(n,r);var b=.15;a.drawImage(t["thin,purple"],b*r.width,b*r.height,r.width*(1-2*b),r.height*(1-2*b)),o+=ee(n+" purple-inner",r)}))})),E=document.createElement("style"),E.innerText=o,document.head.appendChild(E)}},ne={class:"sprite-view"},re=Object(r["f"])(" This is a page for viewing the sprites. These are generated every time the browser loads and are used as the background for "),oe=Object(r["g"])("code",null,".hex",-1),ae=Object(r["f"])(" elements "),ce={class:"sprite-box flex flex-wrap"},ie={ref:"debug"};function se(e,t,n,o,a,c){var i=Object(r["w"])("sprite-nav");return Object(r["q"])(),Object(r["d"])("div",ne,[Object(r["g"])(i),re,oe,ae,Object(r["g"])("div",ce,[(Object(r["q"])(!0),Object(r["d"])(r["a"],null,Object(r["u"])(e.SPRITES,(function(e){return Object(r["q"])(),Object(r["d"])("div",{class:e,key:e},null,2)})),128))]),Object(r["g"])("div",ie,null,512)])}var le={className:"w-full flex m-4"};function ue(e,t,n,o,a,c){var i=Object(r["w"])("router-Link");return Object(r["q"])(),Object(r["d"])("div",le,[(Object(r["q"])(!0),Object(r["d"])(r["a"],null,Object(r["u"])(a.links,(function(e){return Object(r["q"])(),Object(r["d"])("div",{key:e,class:"btn -link"},[Object(r["g"])(i,{to:"/sprite/".concat(e,"/")},{default:Object(r["F"])((function(){return[Object(r["f"])(Object(r["A"])(e),1)]})),_:2},1032,["to"])])})),128))])}var pe=["pieces","hexes"],de={__route:{path:"/sprite/"},data:function(){return{links:pe}}};de.render=ue;var he=de,fe={components:{SpriteNav:he},__route:{path:"/sprite/hexes/"},data:function(){return{SPRITES:L}},mounted:function(){te(this.$route.query.debug&&this.$refs.debug)}};fe.render=se;var be=fe,me={class:"sprite-view"};function ve(e,t,n,o,a,c){var i=Object(r["w"])("sprite-nav");return Object(r["q"])(),Object(r["d"])("div",me,[Object(r["g"])(i),(Object(r["q"])(!0),Object(r["d"])(r["a"],null,Object(r["u"])(e.themes,(function(t){return Object(r["q"])(),Object(r["d"])("div",{key:t},[Object(r["g"])("h2",null,Object(r["A"])(t||"No Theme"),1),Object(r["g"])("div",{class:"flex flex-wrap ".concat(t)},[(Object(r["q"])(!0),Object(r["d"])(r["a"],null,Object(r["u"])(e.piece_list,(function(t){return Object(r["q"])(),Object(r["d"])("div",{key:t},[(Object(r["q"])(!0),Object(r["d"])(r["a"],null,Object(r["u"])(e.players,(function(e){return Object(r["q"])(),Object(r["d"])("div",{class:"relative dummy_piece",key:e},[Object(r["g"])("div",{class:"piece hex hex-".concat(e," type type-").concat(t)},null,2)])})),128))])})),128))],2)])})),128))])}var ge=n("5530"),ye=function(e){return e.replace("_"," ")},_e=function(e){return"The ".concat(ye(e)," must stop moving if it moves next to an enemy trapdoor spider.")},Oe=function(e){return"The ".concat(ye(e)," cannot stack on top of an enemy scorpion.")},we=function(e){return"The ".concat(ye(e)," cannot pass over an orbweaver.")},je=function(e){return e},ke=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"The ".concat(ye(e)," can move one space along the hive").concat(t,".")},xe=[ke("queen")],qe=["If starting on the ground, the emerald wasp can take two steps on top of the hive","If starting on the hive, the emrald wasp can step off the hive",we("emerald_wasp"),Oe("emerald_wasp")],Ee=[ke("beetle"," or step on the hive"),"If starting on the hive, it can move in any direction on or off the hive.",Oe("beetle")],Ce=["Grassshopers fly over the hive in a straight line.",we("grasshopper")],Te=["The cicada jumps over the hive in a straight line as many times as you want.",we("cicada"),_e("cicada")],He=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return["The ".concat(ye(e)," must crawl exactly 3 spaces along the hive."),"The ".concat(ye(e)," can jump over exactly 1 tile except for an orbweaver.")].concat(Object(N["a"])(t))},Ae=He("spider"),Ie=He("scorpion",["No piece can stack on top of an enemy scorpion."]),We=He("orbweaver",["Pieces cannot fly over an orbweaver."]),Pe=He("trapdoor_spider",["The trapdoor spider will stop any piece that tries to crawl past it.","The trapdoor spider cannot not stop a piece which started next to it."]),Se=["The ant can move an unlimited amount of spaces around the hive.",_e("ant")],$e=["The ladybug must take two steps on the hive and then step off the hive.",_e("ladybug")],Ne=["The mosquito copies the movement of any (top most) adjacent bug at the start of its turn.","If the mosquito starts on top of the hive, it moves like a beetle for that turn."],Me=[ke("pill_bug"),je("The pill bug can move an adjacent piece or stack to an empty adjacent space as long as the one-hive rule is not broken by removing the piece.")],Fe=[ke("orchid mantis"," if on the ground level"),"If on the ground level, the orchid mantis can grab an ajacent piece and move it underneath the orchid mantis.","Once on the hive the orchid mantis can move one space on the hive or step off the hive.","The orchid mantis cannot stack on or grab an enemy scorpion."],Ge=["If on the ground level, the kung fu mantis can grab a piece two spaces in any direction and move it underneath the kung fu mantis.","Once on the hive the kung fu mantis can move one space on the hive or step off the hive.","The kung fu mantis cannot stack on or grab an enemy scorpion."],Re=["If starting on the ground, the praying mantis leaps in any direction and lands on the furthest piece.","It cannot leap over any breaks in the hive","If the mantis encounters any stacks while leaping, it will carry the top most piece with it.","If starting on top of a stack, the mantis can only step off the stack onto the ground.",we("praying_mantis"),Oe("praying_mantis")],Le=["If on the ground, the fly can step on the hive.","Once on the hive, the fly take any number of steps on the hive, and then step off the hive.",we("fly"),Oe("fly")],Ue=[ke("lanternfly"),"If surounded on 3 or more sides, the lanternfly can move over the hive to any unoccupied tile on the board."],ze=[ke("lanternfly_nymph"),"The lanternfly nymph can move over the hive to any unoccupied space which is surrounded on 3 or more sides."],De=["The wasp takes unlimited steps on top of the hive and then steps off to any space not touching friendly tiles (opposite of placement).",we("wasp")],Je=["The cockroach must step on the hive, move any number of spaces on the hive, then step on the ground.","However, it cannot step over enemy tiles or friendly orbweavers.",we("cockroach")],Ke=function(e){return["The ".concat(e," moves along diagonals (one step forward then one step left or right)."),je("If the ".concat(e," moves to an empty space, it will carry the piece under it to the new space (as long as it does not break the one-hive rule)."))]},Be=["If on the ground, this can grab any piece one diagonal away (one step forward then one step left or right).","If on the hive, this piece moves on diagonals.","If it moves to an empty space it will carry the piece immediately under it (as long as it does not break the one hive rule)."],Ye=[ke("damselfly"," if on the ground level")].concat(Object(N["a"])(Ke("damselfly")),["(this piece is identical to the dragonfly, but it can move on the ground)"]),Ve=[ke("centipede"),je("The centipede can swap spaces with an adjacent piece as long as removing both pieces would not break the one-hive rule.")],Ze=[ke("earthworm"),"The earthworm can swap with the bottom piece of any stack 3 tiles away.","Removing the bottom piece of a 2+ piece stack will not break the one hive rule."],Qe=["An inert tile that cannot move"],Xe={queen:xe,beetle:Ee,grasshopper:Ce,cicada:Te,spider:Ae,ant:Se,ladybug:$e,mosquito:Ne,pill_bug:Me,orchid_mantis:Fe,kung_fu_mantis:Ge,praying_mantis:Re,fly:Le,lanternfly:Ue,lanternfly_nymph:ze,wasp:De,cockroach:Je,dragonfly:Ke("dragonfly"),damselfly:Ye,dragonfly_nymph:Be,centipede:Ve,earthworm:Ze,blank:Qe,emerald_wasp:qe,scorpion:Ie,trapdoor_spider:Pe,orbweaver:We},et={slugs:["basics","onehive","stacks","queen","beetle","earthworm","grasshopper","ant","spider","ladybug","mosquito","pill_bug","kung_fu_mantis","orchid_mantis","praying_mantis","fly","wasp","scorpion","cockroach","dragonfly","damselfly","dragonfly_nymph","centipede","cicada","lanternfly","lanternfly_nymph","trapdoor_spider","orbweaver","emerald_wasp"],basics:["To start, each player places a piece next to each other.","Each turn a player can either *place* one piece or move one piece.","The goal of the game is to surround the enemy queen on all sides.","Pieces can only be placed next to a friendly piece (except for the first two turns).","Other than during the placing phase, every piece moves differently.","Clicking on a piece shows all possible moves (even if it is the other players turn)."],onehive:['Each piece moves differently, but the board must always be "one hive".',"A piece cannot move if moving that piece would break the hive (even temporarily).","Pieces that cannot move or be moved without violating this rule are grayed out."],stacks:["Some pieces can move onto the hive.","For placing or similar purposes, only the color of the top piece matters.","Only the top piece on a stack can move or be moved."],queen:["From this position, the white queen can move to one of two spaces. It cannot move between the beetle and ant because it cannot fit.","The black queen cannot move without breaking the hive."],beetle:["From on top of the hive, the white beetle can step down to one of four spaces or continue on the hive by moving onto one of two tiles.","From the ground, the black beetle can step along the hive or step on the hive for a total of five possible moves."],grasshopper:["The black grasshopper can move to three different spaces.","The white grasshopper can move to two different spaces.","With super_grasshopper turned on the black and white pieces can move to 6 and 7 spaces respectively."],spider:["From this position, the white spider can move to one of three spaces."],ant:["Normally, both ants can move to any open space on the board.","If spiderwebs are enabled, the black ant can get trapped on the far spider."],ladybug:["The black ladybug can move to one of five open spaces, the white ladybug eight."],mosquito:["From this position, the black mosquito can move as a scorpion, queen, or grasshopper.","On top of the hive, the white mosquito moves like a beetle. It cannot step on the scorpion because have you ever stepped on a scorpion? It hurts."],pill_bug:["From this position, the pill bug can move to one of two spaces.","Alternatively, it can move the white queen to one of three spaces."],kung_fu_mantis:["From on top the hive, the black mantis can take one step in any direction.","From the ground, the white mantis can pull the black queen under itself."],orchid_mantis:["The white orchid mantis cannot move, but it can pull the queen or grasshopper under itself.","From on top of the hive, the black orchid mantis moves like a beetle."],praying_mantis:["The white praying mantis can move onto the white ant or black queen. If it moves onto the white queen it will move the white beetle as well.","From on top of the hive, the black praying mantis can step off the hive."],fly:["The white fly can climb onto one of two pieces.","From on top of the hive, the black fly can move to any ground level space (except those blocked by scorpions)."],scorpion:["From this position the scorpion can move to one of two spaces.","The beetle and grasshopper have their moves restricted by the adjacent scorpion."],wasp:["The black wasp can move to one of four spaces.","The white wasp can move to one of six spaces."],cockroach:["The black cockroach can step on any adjacent black piece, and then off the hive for a total of 8 possible moves.","The white cockroach is blocked by the enemy beetle and fly, and cannot move at all."],dragonfly:["The black dragonfly can move to one of three spaces. It cannot land on the scorpion","The white dragonfly has six possible moves. If it moves to one of the three unoccupied spaces, it must move the spider its on top of as well."],damselfly:["The black damselfly can move along the hive to one of two spaces or diagonally to one of three spaces. It cannot land on the scorpion","The white damselfly has six possible moves. If it moves to one of the five unoccupied spaces, it must move the spider its on top of as well."],dragonfly_nymph:["The black dragonfly nymph can pull the white queen under it.","From on top the hive, the white dragonfly nymph can move diagonally to 5 different spaces."],centipede:["From this position, the centipede can move to one of two spaces.","Alternatively, it can switch places with the grasshopper."],cicada:["The black cicada can make one move by jumping over the hive.","The white cicada can jump over the ant or jump over the white queen, black queen, and black cicada (stopping anywhere along the way)."],lanternfly:["The white laternfly can move one space in either direction.","Surrounded on 3 sides, the black lantern fly can move over the hive to any square."],lanternfly_nymph:["Either lanternfly nymph can move to 4 different spaces."],trapdoor_spider:["The white trapdoor spider has 3 possible hop over 4 tiles or move 3 tiles along the hive.","The black trapdoor spider cannot move (one hive rule)","If either cicada lands next to the enemy trapdoor spider, it stops moving.","The white ant cannot move past the black spider.","The black ant starts touching the white spider, so it cannot get trapped by its webs."],orbweaver:["Every piece is in some way limited by both friendly and enemy orbweavers."],emerald_wasp:["The black emerald wasp move onto two spaces (by first stepping on the white emerald wasp).","The whiet emerald wasp can step off the hive to three different spaces."],earthworm:["Both earthworms can swap with 4 different pieces."]},tt={queen:{W:8,H:6,stacks:{18:[2],20:[4],25:[7],27:[5],29:[1],35:[3],36:[6],37:[0]},piece_types:["queen","beetle","queen","ant","spider","ant","ant","grasshopper"],piece_owners:[1,2,2,2,1,1,1,2],turn:20,rules:{},current_player:1},beetle:{W:6,H:5,stacks:{8:[1],13:[0,2],14:[6],15:[5],20:[3],21:[4]},piece_types:["grasshopper","queen","beetle","queen","grasshopper","beetle","grasshopper"],piece_owners:[2,2,1,1,1,2,2],turn:9,rules:{},current_player:2},grasshopper:{W:8,H:4,stacks:{10:[2],11:[0],12:[1],18:[4],19:[3],20:[5],21:[6]},piece_types:["queen","beetle","grasshopper","ant","queen","spider","grasshopper"],piece_owners:[2,2,2,1,1,1,1],turn:9,rules:{},current_player:2},spider:{W:8,H:6,stacks:{19:[0],20:[1],26:[5],27:[3],28:[4],29:[2]},piece_types:["spider","beetle","queen","queen","beetle","grasshopper"],piece_owners:[1,1,1,2,2,2],turn:13,rules:{},current_player:2},ant:{W:8,H:6,stacks:{12:[7],18:[5],20:[1],25:[6],27:[2],28:[4],29:[0],35:[8],37:[3]},piece_types:["ant","spider","grasshopper","grasshopper","grasshopper","spider","queen","queen","ant"],piece_owners:[2,1,1,2,2,1,1,2,1],turn:42,rules:{},current_player:1},ladybug:{W:6,H:5,stacks:{7:[0],9:[5],10:[8],13:[1],14:[2],15:[4],16:[6],19:[7],20:[3]},piece_types:["ladybug","grasshopper","beetle","queen","mosquito","queen","spider","ant","ladybug"],piece_owners:[2,1,1,1,2,2,1,2,1],turn:10,rules:{},current_player:1},mosquito:{W:6,H:6,stacks:{14:[0],15:[3],16:[5],20:[1,6],21:[2],22:[4]},piece_types:["scorpion","queen","grasshopper","mosquito","beetle","queen","mosquito"],piece_owners:[2,1,1,2,1,2,1],turn:16,rules:{},current_player:1},pill_bug:{W:6,H:6,stacks:{8:[4],14:[3],15:[5],19:[0],20:[2],25:[1]},piece_types:["pill_bug","queen","spider","grasshopper","queen","ant"],piece_owners:[1,1,1,2,2,2],turn:8,rules:{},current_player:1},orchid_mantis:{W:8,H:6,stacks:{11:[5,6],12:[3],20:[2],21:[4],27:[0],28:[1],35:[7]},piece_types:["orchid_mantis","queen","beetle","queen","ant","ant","orchid_mantis","grasshopper"],piece_owners:[1,1,2,2,2,1,2,1],turn:9,rules:{},current_player:2},fly:{W:50,H:50,stacks:{1176:[6],1225:[5],1227:[8],1273:[4],1274:[0,2],1275:[1],1276:[3],1277:[7]},piece_types:["queen","queen","fly","orchid_mantis","wasp","fly","wasp","scorpion","scorpion"],piece_owners:[1,2,2,2,1,1,1,2,1],turn:14,rules:{},current_player:1},scorpion:{W:6,H:5,stacks:{8:[2],13:[1],15:[3],16:[5],19:[0],21:[4],22:[6]},piece_types:["queen","spider","beetle","queen","grasshopper","beetle","scorpion"],piece_owners:[1,1,2,2,2,2,1],turn:11,rules:{},current_player:2},wasp:{W:6,H:6,stacks:{8:[1],13:[0],14:[2],15:[4],19:[3],20:[5],25:[6]},piece_types:["ant","queen","wasp","queen","wasp","beetle","grasshopper"],piece_owners:[2,2,2,1,1,1,2],turn:8,rules:{},current_player:1},dragonfly:{W:6,H:5,stacks:{7:[7],8:[3],14:[1,0],15:[4],19:[6],20:[2],21:[5]},piece_types:["dragonfly","spider","queen","scorpion","queen","beetle","dragonfly","spider"],piece_owners:[1,1,1,2,2,2,2,1],turn:14,rules:{},current_player:1},damselfly:{W:6,H:5,stacks:{7:[7],8:[3],14:[1,0],15:[4],19:[6],20:[2],21:[5]},piece_types:["damselfly","spider","queen","scorpion","queen","beetle","damselfly","spider"],piece_owners:[1,1,1,2,2,2,2,1],turn:14,rules:{},current_player:1},dragonfly_nymph:{actions:[],W:50,H:50,stacks:{1225:[4],1273:[2],1274:[3,0],1275:[1],1323:[5]},piece_types:["dragonfly_nymph","dragonfly_nymph","queen","queen","lanternfly_nymph","centipede"],piece_owners:[1,2,1,2,2,1],hash:"cb6ca89c583ff67546d37a5b4453bf1b714fe20e",turn:7,rules:{},last:{to:1323},current_player:2},centipede:{W:6,H:6,stacks:{10:[6],14:[4],15:[3,5],20:[0],21:[2],27:[1]},piece_types:["queen","grasshopper","centipede","ant","ladybug","beetle","queen"],piece_owners:[1,1,2,2,2,1,2],turn:10,rules:{},current_player:1},cockroach:{W:8,H:6,stacks:{12:[3],14:[6],18:[1],19:[2],20:[5],21:[4,7],27:[0]},piece_types:["queen","cockroach","beetle","queen","fly","ant","cockroach","beetle"],piece_owners:[1,1,2,2,2,1,2,1],hash:.5479472595173172,turn:20,rules:{},current_player:1},cicada:{actions:[],W:50,H:50,stacks:{1226:[3],1273:[2],1274:[0],1275:[1],1323:[4]},piece_types:["queen","queen","cicada","cicada","ant"],piece_owners:[1,2,1,2,1],hash:"21f05bca4e8cc4257c4de80ac6dfdd6aaa971ec0",turn:5,rules:{pieces:{beetle:2,ant:3,centipede:1,cockroach:1,cicada:2}},current_player:2},lanternfly:{W:50,H:50,stacks:{1222:[6],1225:[5],1226:[7],1273:[2],1274:[0],1275:[1],1276:[3],1323:[4]},piece_types:["queen","beetle","beetle","queen","lanternfly","ant","cicada","lanternfly"],piece_owners:[1,2,1,2,1,2,1,2],hash:"c3ebd4ae845992bc447b61ee23449c23cfd8ea41",turn:8,rules:{pieces:{beetle:2,ant:3,lanternfly:1,centipede:1,cockroach:1,cicada:2}},current_player:1},lanternfly_nymph:{actions:[],W:50,H:50,stacks:{1223:[8],1226:[5],1273:[2],1274:[0],1275:[1],1276:[3],1323:[4],1324:[6],1326:[7]},piece_types:["pill_bug","mosquito","queen","pill_bug","lanternfly_nymph","lanternfly_nymph","centipede","queen","orchid_mantis"],piece_owners:[1,2,1,2,1,2,1,2,1],hash:"3e89a125b257082f0a7cd6687cec8c0303eab5d3",turn:16,rules:{},current_player:1},trapdoor_spider:{W:50,H:50,stacks:{1226:[6],1274:[0],1275:[1],1276:[3],1277:[5],1323:[4],1325:[2],1327:[7]},piece_types:["trapdoor_spider","trapdoor_spider","queen","queen","cicada","ant","ant","cicada"],piece_owners:[1,2,1,2,1,2,1,2],rules:{},current_player:2},orbweaver:{actions:[],W:50,H:50,stacks:{1174:[10,8],1176:[5],1222:[12],1225:[3],1272:[6],1273:[2],1274:[0],1275:[1],1276:[7],1325:[11],1322:[9],1323:[4]},piece_types:["orbweaver","grasshopper","grasshopper","orbweaver","queen","queen","wasp","fly","fly","trapdoor_spider","trapdoor_spider","cockroach","cockroach"],piece_owners:[1,2,1,2,1,2,1,2,1,2,1,2,1],turn:18,rules:{},last:{from:1226,to:1277},current_player:1,last_move_at:1604858870793},praying_mantis:{W:50,H:50,stacks:{1225:[5],1273:[6],1274:[0,4],1275:[1],1276:[7,3],1323:[2]},piece_types:["queen","queen","praying_mantis","praying_mantis","beetle","fly","ant","beetle"],piece_owners:[1,2,1,2,1,2,1,2],turn:14,last:{from:1325,special:1276},current_player:1,rules:{}},emerald_wasp:{W:50,H:50,stacks:{1225:[5],1273:[2],1274:[0],1275:[1,4],1276:[3]},piece_types:["beetle","beetle","queen","queen","emerald_wasp","emerald_wasp"],piece_owners:[1,2,1,2,1,2],turn:7,rules:{},current_player:2},kung_fu_mantis:{W:50,H:50,stacks:{1224:[7],1225:[4,3],1274:[0],1275:[1],1276:[5],1323:[6],1324:[2],1325:[8]},piece_types:["queen","queen","ant","kung_fu_mantis","grasshopper","ant","kung_fu_mantis","ladybug","ladybug"],piece_owners:[1,2,1,2,1,2,1,1,2],turn:13,rules:{},current_player:2},earthworm:{actions:[],W:50,H:50,stacks:{1223:[8],1225:[3],1226:[7],1273:[0,6],1274:[2],1275:[1],1276:[5],1323:[4]},piece_types:["centipede","pill_bug","queen","earthworm","earthworm","dragonfly","beetle","queen","lanternfly_nymph"],piece_owners:[1,2,1,2,1,2,1,2,1],hash:"1d4cc628d73f7cc48ab20a7b3a4800f37e13b3f3",turn:16,rules:{},current_player:1}},nt={beetle:2,grasshopper:3,ant:3,spider:2},rt=Object(ge["a"])(Object(ge["a"])({queen:1},nt),{},{ladybug:1,mosquito:1,pill_bug:1,orchid_mantis:2,fly:3,wasp:3,dragonfly:1,cockroach:1,centipede:1,scorpion:2,trapdoor_spider:2,orbweaver:2,cicada:3,lanternfly:3,lanternfly_nymph:3,earthworm:1,damselfly:1,dragonfly_nymph:2,praying_mantis:1,emerald_wasp:1,kung_fu_mantis:1}),ot={ant:"#0088e6",beetle:"#b95cb9",centipede:"#b98900",cicada:"#4b9400",cockroach:"#b95c2b",dragonfly:"#e62b00",dragonfly_nymph:"#e62b00",damselfly:"#e67000",earthworm:"#dc5797",fly:"#2a5c00",grasshopper:"#4b9400",ladybug:"#b90000",lanternfly:"#ac3a3a",lanternfly_nymph:"#ac3a3a",orchid_mantis:"#008b5c",orbweaver:"#900000",praying_mantis:"#008b5c",mosquito:"#8a8a8a",pill_bug:"#005cb9",scorpion:"#5c008b",spider:"#5c2900",trapdoor_spider:"#5c2900",queen:"#e6b900",wasp:"#e62b8b",emerald_wasp:"#43b38c",kung_fu_mantis:"#aa3355"},at={hive:["beetle","grasshopper","ant","spider","ladybug","mosquito","pill_bug"],crawl:["trapdoor_spider","spider","cicada","ant"],fly:["orbweaver","lanternfly","fly","wasp","cockroach","grasshopper","cicada","ladybug","praying_mantis"],stack:["scorpion","beetle","orchid_mantis","praying_mantis","dragonfly","damselfly"],special:["mosquito","centipede","pillbug","earthworm"],all:Object.keys(rt)},ct=function(e){var t=e.rules.unlimited,n={1:{},2:{}};e.piece_types.forEach((function(t,r){var o=e.piece_owners[r];n[o][t]=(n[o][t]||0)+1}));var r=[],o=Object(ge["a"])({blank:0,queen:1},e.rules.pieces);return Object.entries(n).forEach((function(e){var n=Object(H["a"])(e,2),a=n[0],c=n[1];Object.entries(o).forEach((function(e){var n=Object(H["a"])(e,2),o=n[0],i=n[1];c[o]=c[o]||0;var s=t?1:i-c[o];s>0&&r.push({type:o,player_id:a,count:s})}))})),r},it={VANILLA:nt,getAvailable:ct,piece_counts:rt,tags:at,list:Object.keys(rt),colors:ot};at.all.forEach((function(e){var t={captions:et,help:Xe,colors:ot,boards:tt};Object.entries(t).forEach((function(t){var n=Object(H["a"])(t,2),r=n[0],o=n[1];o[e]||console.log("missing",r,e)}))}));var st=["player_1","player_2"],lt=["","theme-carbon"],ut={__route:{path:"/sprite/pieces/"},components:{SpriteNav:he},data:function(){return{players:st,themes:lt,piece_list:it.list}},mounted:function(){te()}};ut.render=ve;var pt=ut,dt={makeSprites:te,views:{Hexes:be,Nav:he,Pieces:pt}},ht=(n("fb6a"),n("a630"),n("3ca3"),"data-vue-router-controlled"),ft=function(e,t,n){var r=e.matched.slice().reverse().find((function(e){var t;return null===(t=e.meta)||void 0===t?void 0:t.title}));r&&(document.title=r.meta.title);var o=e.matched.slice().reverse().find((function(e){var t;return null===(t=e.meta)||void 0===t?void 0:t.metaTags}));Array.from(document.querySelectorAll("[".concat(ht,"]"))).forEach((function(e){return e.parentNode.removeChild(e)})),null===o||void 0===o||o.meta.tags.forEach((function(e){var t=document.createElement("meta");Object.keys(e).forEach((function(n){return t.setAttribute(n,e[n])})),t.setAttribute(ht,""),document.head.appendChild(t)})),n()},bt="\n* Game rules and (most) design elements originated from the borad game Hive by Jhon Yianni. [Learn more at Board Game Geek](https://boardgamegeek.com/forums/thing/2655/hive).\n* Assets and extra rules taken from [A collection of variant pieces ](https://boardgamegeek.com/filepage/90063/collection-variant-pieces) and [Hive Swarm](https://boardgamegeek.com/filepage/95016/hive-swarm).\n* This article on [Hexagonal Grids](https://www.redblobgames.com/grids/hexagons/) by Red Blob Games was used frequently while writting this program.\n* This app was made by me using react and is hosted at github at [chriscauley/hive.js](https://github.com/chriscauley/hive.js/). Feel free to create an issue or message [@chriscauley](https://boardgamegeek.com/user/chriscauley) on Board Game Geek.\n* Icons made by [Freepik](https://www.flaticon.com/authors/freepik) and [Vitaly Gorbachev](https://www.flaticon.com/authors/vitaly-gorbachev) at www.flaticon.com\n",mt={__route:{path:"/about/",meta:{}},render:function(){return Object(r["g"])("section",null,[Object(r["g"])("div",{className:b.a.modal.outer("-relative")},[Object(r["g"])("div",{className:b.a.modal.content("-auto")},[Object(r["g"])("h2",null,[Object(r["f"])("About")]),Object(r["g"])(Object(r["w"])("unrest-markdown"),{source:bt,className:"markdown"},null)])])])}},vt={class:"text-center pb-2"},gt=Object(r["g"])("h2",null,"Welcome!",-1),yt=Object(r["f"])(" Start Online Game "),_t=Object(r["g"])("div",{class:"font-bold font-xl mb-4"},"-- OR --",-1),Ot=Object(r["f"])(" Start Local Game "),wt=Object(r["f"])(" Create An Account "),jt=Object(r["f"])(" Log In ");function kt(e,t,n,o,a,c){var i=Object(r["w"])("router-link");return e.$auth.ready?(Object(r["q"])(),Object(r["d"])("div",{key:0,class:a.css.modal.outer("-relative")},[Object(r["g"])("div",{class:a.css.modal.content("-auto")},[Object(r["g"])("div",vt,[gt,e.$auth.user?(Object(r["q"])(),Object(r["d"])(r["a"],{key:0},[e.$auth.enabled?(Object(r["q"])(),Object(r["d"])(r["a"],{key:0},[Object(r["g"])(i,{to:"/new/online/",class:a.css.button("block mb-4")},{default:Object(r["F"])((function(){return[yt]})),_:1},8,["class"]),_t],64)):Object(r["e"])("",!0),Object(r["g"])(i,{to:"/new/local/",class:a.css.button("block")},{default:Object(r["F"])((function(){return[Ot]})),_:1},8,["class"])],64)):(Object(r["q"])(),Object(r["d"])(r["a"],{key:1},[Object(r["g"])("div",{onClick:t[1]||(t[1]=function(){return c.makeGuest&&c.makeGuest.apply(c,arguments)}),class:a.css.button("block mb-4")}," Play as Guest ",2),Object(r["g"])(i,{to:a.signup,class:a.css.button("block mb-4")},{default:Object(r["F"])((function(){return[wt]})),_:1},8,["to","class"]),Object(r["g"])(i,{to:a.login,class:a.css.button("block")},{default:Object(r["F"])((function(){return[jt]})),_:1},8,["to","class"])],64))])],2)],2)):Object(r["e"])("",!0)}var xt={__route:{path:"/"},data:function(){var e=this.$route.query,t={path:"/auth/sign-up/",query:e},n={path:"/auth/login/",query:e};return{css:b.a,signup:t,login:n}},methods:{makeGuest:function(){var e=this;this.$auth.api.post("auth/guest/").then(this.$auth.refetch).then((function(){e.$route.query.next&&e.$router.replace(e.$route.query.next)}))}}};xt.render=kt;var qt=xt,Et={"v1.0.2 Dec 28, 2020":["NEW PIECE: Praying Mantis can leap onto furthest piece in any direction and drag a stacked piece with it.","NEW PIECE: Kung Fu Mantis can grab a piece two spaces away and move it underneath.","NEW PIECE: Emerald Wasp can take two steps onto the hive (or step off if starting on the hive).","NEW PIECE: Lanternfly Nymph can move to any empty space surrounded on 3 or more sides.","Mosquito can now copy every move by every piece (does not copy passives).","Minor ui tweaks."],"v1.0.1 Nov 14, 2020":["NEW PIECE: Lanternfly can fly over the hive to any open space is touching pieces on 3 sides (otherwise moves like queen).","NEW PIECE: Orbweaver Spider moves like a spider and no piece can move over it (this ability has been taken from scorpion which now only blocks stacking pieces).","Changed all variations (spiderwebs, venom_centipede, damselfly, super grasshopper) into piece (trapdoor spider, earthworm, damselfly, cicada)",'Added preview piece widget to New Game and "waiting for host to select rules" screens.',"All pieces are now svgs."],"v.1.0.0b Oct 24, 2020":["Pick any combinaton of tiles in new game.","Select stack + hover to expand"],"v1.0.0a Oct 17, 2020":["Dark mode! (config dropdown)","Changed fly completely (email me if you want me to add original in as a variant). Old fly was only useful in very rare circumstances.",'Added "lotus mantis" variant because default mantis was very underpowered. Lotus Mantis is on par with beetle.',"Added help text for damselfly, lotus mantis, and new fly.","Lots of improvements to game backend in preparation of replays."]},Ct=function(e){return e.split(" ")[0].replace(/\./g,"-")},Tt={__route:{path:"/change-log/",meta:{}},render:function(){return Object(r["g"])("div",null,[Object(r["g"])("div",{className:b.a.modal.outer(),style:{position:"relative",zIndex:1}},[Object(r["g"])("div",{className:b.a.modal.content()},[Object(r["g"])("h2",null,[Object(r["f"])("Change Log")]),Object.entries(Et).map((function(e){var t=Object(H["a"])(e,2),n=t[0],o=t[1];return Object(r["g"])("div",{key:n,id:Ct(n),className:"mb-4 pb-2 border-b border--text-alt last:border-b-0"},[Object(r["g"])("h3",null,[n]),Object(r["g"])("ul",{className:"browser-default"},[o.map((function(e){return Object(r["g"])("li",{key:e},[e])}))])])}))])])])}},Ht={__route:{path:"/new/:location/",meta:{authRequired:!0}},render:function(){return Object(r["g"])("div",null,null)},mounted:function(){var e=this;"online"!==this.$route.params.location?this.$router.replace("/play/local/"):this.$store.room.save({}).then((function(t){var n=t.id;return e.$router.replace("/play/".concat(n,"/"))}))}},At={key:0,class:"online-room"},It={class:"online-room__left"};function Wt(e,t,n,o,a,c){var i=Object(r["w"])("game"),s=Object(r["w"])("new-game"),l=Object(r["w"])("ur-chat-widget");return c.room?(Object(r["q"])(),Object(r["d"])("div",At,[Object(r["g"])("div",It,[c.room.board?(Object(r["q"])(),Object(r["d"])(i,{key:0,room:c.room},null,8,["room"])):(Object(r["q"])(),Object(r["d"])(s,{key:1,room:c.room,setRules:c.setRules,startGame:c.startGame},null,8,["room","setRules","startGame"]))]),"local"!==c.room_id?(Object(r["q"])(),Object(r["d"])(l,{room_id:c.room_id,key:c.room_id},null,8,["room_id"])):Object(r["e"])("",!0)])):Object(r["e"])("",!0)}var Pt={class:"new-game__wrapper"},St={key:0,class:"new-game"},$t={class:"flex justify-between items-center"},Nt={class:"flex"},Mt={key:0},Ft={key:1,class:"mt-2 flex items-center"},Gt=Object(r["g"])("i",{class:"fa fa-warning text-yellow-500 mr-2"},null,-1),Rt=Object(r["f"])(" Waiting for players... "),Lt=Object(r["g"])("i",{class:"fa fa-copy mr-1"},null,-1),Ut={class:"w-1/2"},zt={key:0,class:"h-full"},Dt={class:"flex items-center text-3xl font-bold"},Jt={style:{width:"36px, height: 32px"},class:"relative mr-2"},Kt={class:"browser-default"},Bt={key:1};function Yt(e,t,n,o,a,c){var i=Object(r["w"])("rule-list"),s=Object(r["w"])("hive-piece");return Object(r["q"])(),Object(r["d"])("div",Pt,[c.rules?(Object(r["q"])(),Object(r["d"])("div",St,[Object(r["g"])("div",$t,[Object(r["g"])("h2",null,Object(r["A"])(c.is_host?"Choose pieces":"Host is choosing pieces"),1),Object(r["g"])("div",null,Object(r["A"])(c.total_pieces)+" pieces selected",1)]),Object(r["g"])("div",Nt,[Object(r["g"])("div",{class:"w-1/2 ".concat(c.is_host?"":"is_guest")},[Object(r["g"])(i,{rules:c.rules,onClick:c.onClick,onHover:function(e){return a.hovering=e}},null,8,["rules","onClick","onHover"]),c.is_host?(Object(r["q"])(),Object(r["d"])("div",Mt,[c.can_start?(Object(r["q"])(),Object(r["d"])("button",{key:0,class:a.css.button("mt-4 mr-4"),onClick:t[1]||(t[1]=function(){return n.startGame&&n.startGame.apply(n,arguments)})}," Start ",2)):(Object(r["q"])(),Object(r["d"])("div",Ft,[Gt,Rt,Object(r["g"])("div",{class:"btn -primary ml-4",onClick:t[2]||(t[2]=function(){return c.copyUrl&&c.copyUrl.apply(c,arguments)})},[Lt,Object(r["f"])(" "+Object(r["A"])(a.copied?"Copied!":"Copy url"),1)])]))])):Object(r["e"])("",!0)],2),Object(r["g"])("div",Ut,[a.hovering?(Object(r["q"])(),Object(r["d"])("div",zt,[Object(r["g"])("div",Dt,[Object(r["g"])("div",Jt,[Object(r["g"])(s,{type:a.hovering,player:2},null,8,["type"])]),Object(r["f"])(" "+Object(r["A"])(c.title(a.hovering)),1)]),Object(r["g"])("ul",Kt,[(Object(r["q"])(!0),Object(r["d"])(r["a"],null,Object(r["u"])(c.hovering_lines,(function(e){return Object(r["q"])(),Object(r["d"])("li",{key:e},Object(r["A"])(e),1)})),128))])])):(Object(r["q"])(),Object(r["d"])("p",Bt,Object(r["A"])(c.empty_text),1))])])])):Object(r["e"])("",!0)])}n("07ac"),n("a15b");var Vt="Move one square along the hive.",Zt="Cannot step on scorpion.",Qt="Cannot move over orbweaver.",Xt="Will stop moving if it touches the trapdoor spider.",en=function(e){return["Move three steps along hive.","Jump over one tile."].concat(Object(N["a"])(e))},tn="Moves like a beetle if it starts a turn on the hive.",nn=[Vt,"If surrounded, you lose.","You can only have one queen."],rn=[Vt,"Can move onto hive.",Zt],on=["Hops over hive.",Qt],an=["Can make unlimited jumps over the hive.",Qt,Xt],cn=en([]),sn=["Can move unlimited spaces along the hive.",Xt],ln=["Takes two steps on hive then one step off.",Qt],un=["Copies the movement and restrictions of any piece it is touching.",tn,"Cannot copy special abilities."],pn=[Vt,"Can move any piece it is touching to another empty square."],dn=[Vt,"Can pull a piece under itself.",tn,Zt],hn=["Can pull a piece two spaces in any direction under itself.",tn,Zt],fn=["Can jump over the hive and land on the furthest piece in any direction","Will carry a stacked piece with it when it jumps.","If on the hive, can only step on the ground.",Qt,Zt],bn=["If on ground, can step on the hive.","If on the hive, can fly to any open square.",Qt,Zt],mn=[Vt,"If touching pieces on 3 sides, can fly anywhere.",Qt],vn=[Vt,"Can fly to any space surrounded on 3 or more sides."],gn=["Can fly over hive and land in any space not touching a friendly piece.",Qt],yn=["Can move over friendly pieces to any empty space.",Qt],_n=["Can move one space forward than one space left or right.","If it moves from a stack to an empty space, it will carry one piece with it."],On=["If on the ground, can move along the hive."].concat(_n),wn=["If on the ground can pull any piece under it from one diagonal away (one space forward and one to the right or left).","If on the hive it moves one diagonal in any direction.","If it moves to an empty space it will carry the piece under along with it."],jn=[Vt,"Can swap with an adjacent piece."],kn=[Vt,"Can swap with the bottom piece of any stack 3  (on hive) moves away."],xn=en(["No piece can move over.","Defends against grasshopper, cicada, ladybug, fly, wasp, and cockroach."]),qn=en(["Traps any piece that moves next to it.","Defends against ant and cicada."]),En=en(["No piece can stack on top of the scorpion.","Defends against beetle, fly, dragonfly, and orchid mantis, kung fu mantis, and praying mantis."]),Cn=["If on the ground, can take two steps onto the hive.","If on the hive, can only step on the ground.",Qt,Zt],Tn={queen:nn,beetle:rn,grasshopper:on,cicada:an,spider:cn,ant:sn,ladybug:ln,mosquito:un,pill_bug:pn,orchid_mantis:dn,kung_fu_mantis:hn,praying_mantis:fn,fly:bn,lanternfly:mn,lanternfly_nymph:vn,wasp:gn,cockroach:yn,dragonfly:_n,dragonfly_nymph:wn,damselfly:On,centipede:jn,earthworm:kn,orbweaver:xn,trapdoor_spider:qn,scorpion:En,emerald_wasp:Cn},Hn={class:"RuleList mt-4"},An={class:"row"};function In(e,t,n,o,a,c){var i=Object(r["w"])("hive-piece");return Object(r["q"])(),Object(r["d"])("div",Hn,[(Object(r["q"])(!0),Object(r["d"])(r["a"],null,Object(r["u"])(a.piece_lists,(function(e,o){return Object(r["q"])(),Object(r["d"])("span",{key:o,class:"hex-grid TutorialNav"},[Object(r["g"])("div",An,[(Object(r["q"])(!0),Object(r["d"])(r["a"],null,Object(r["u"])(e,(function(e){return Object(r["q"])(),Object(r["d"])(i,{key:e,title:e,player:o,type:e,count:c.getCount(e),onClick:function(t){var r;return null===(r=n.onClick)||void 0===r?void 0:r.call(n,t,e)},onMouseover:function(t){var r;return null===(r=n.onHover)||void 0===r?void 0:r.call(n,e)},onMouseout:t[1]||(t[1]=function(e){var t;return null===(t=n.onHover)||void 0===t?void 0:t.call(n,null)})},null,8,["title","player","type","count","onClick","onMouseover"])})),128))])])})),128))])}var Wn={class:"item"};function Pn(e,t,n,o,a,c){return Object(r["q"])(),Object(r["d"])("div",Wn,[Object(r["g"])("div",{className:"content","data-count":n.count},[Object(r["g"])("div",{class:c.css},null,2)],8,["data-count"])])}var Sn={props:{count:[Number,String],player:Number,type:String},computed:{css:function(){var e=this.player,t=this.type;return"hex hex-player_".concat(e%2+1," type type-").concat(t," piece")}}};Sn.render=Pn;var $n=Sn,Nn={components:{HivePiece:$n},props:{rules:Object,onClick:Function,onHover:Function},data:function(){var e=5,t=[],n=[t];return it.list.forEach((function(r){t.length===e&&n.push(t=[]),t.push(r)})),{piece_lists:n}},mounted:function(){dt.makeSprites()},methods:{getCount:function(e){return"queen"===e?"lock":this.rules.pieces[e]||0}}};Nn.render=In;var Mn=Nn,Fn=function(e){return e&&Object.keys(e.pieces).forEach((function(t){it.piece_counts[t]||delete e.pieces[t]})),e},Gn="\nChoose which pieces to play with. Click adds a piece, shift+click removes it.\nHover over a piece to read more. It's recommended that you choose 10-12 pieces.\n",Rn="\nWaiting for host to choose pieces. Check out the rules while you wait.\nHover over a piece to read more. Use the chat to request the host change pieces.\n",Ln=8,Un="NEW_GAME_RULES",zn={components:{RuleList:Mn,HivePiece:$n},props:{room:Object,setRules:Function,startGame:Function},data:function(){var e=window.location.href;return{hovering:null,css:b.a,copied:null,href:e}},computed:{is_host:function(){var e;return"local"===this.room.id||this.room.state.host_id===(null===(e=this.$store.auth.user)||void 0===e?void 0:e.id)},rules:function(){var e=this.room.state.rules;return!e&&this.is_host&&(e=Fn($.a.get(Un)||{variants:{},pieces:Object(ge["a"])({},it.VANILLA)}),this.setRules(e)),Fn(e)},total_pieces:function(){return Object.values(this.rules.pieces).reduce((function(e,t){return e+t}),0)},empty_text:function(){return this.is_host?Gn:Rn},hovering_lines:function(){return Tn[this.hovering]},can_start:function(){if("local"===this.room.id)return!0;var e=this.room.state,t=e.player_id,n=e.afk;return t&&!n.includes(t)}},methods:{title:function(e){return e.split("_").map((function(e){return e[0].toUpperCase()+e.slice(1)})).join(" ")},onClick:function(e,t){if(this.is_host){var n=this.rules;n.pieces[t]=n.pieces[t]||0,n.pieces[t]+=e.shiftKey?-1:1,n.pieces[t]<0?n.pieces[t]=Ln:n.pieces[t]>Ln&&(n.pieces[t]=0),this.setRules(n)}},copyUrl:function(){var e=this,t=document.createElement("input");t.value=window.location.href,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),this.copied=!0,setTimeout((function(){return e.copied=!1}),5e3)}}};zn.render=Yt;var Dn=zn,Jn={class:"game"},Kn={class:"scroll-box",ref:"scroll_box"},Bn={class:"inner"};function Yn(e,t,n,o,a,c){var i=Object(r["w"])("hive-board"),s=Object(r["w"])("help-text"),l=Object(r["w"])("winner"),u=Object(r["w"])("no-rules"),p=Object(r["w"])("time-since");return Object(r["q"])(),Object(r["d"])("div",Jn,[Object(r["g"])(i,{rows:c.rows.player_1,class:c.css.player(1,c.rows.player_1),onClickPiece:c.click},null,8,["rows","class","onClickPiece"]),Object(r["g"])(i,{rows:c.rows.player_2,class:c.css.player(2,c.rows.player_2),onClickPiece:c.click},null,8,["rows","class","onClickPiece"]),Object(r["g"])("div",Kn,[Object(r["g"])("div",Bn,[Object(r["g"])(i,{rows:c.rows.rows,class:"game_board",onClickPiece:c.click},null,8,["rows","onClickPiece"])])],512),Object(r["g"])(s,Object(r["l"])(c.board.selected,{board:c.board}),null,16,["board"]),Object(r["g"])("div",{class:c.css.player_indicator},[c.board.winner?(Object(r["q"])(),Object(r["d"])(l,{key:0,board:c.board,room:n.room},null,8,["board","room"])):Object(r["e"])("",!0),c.board.rules.no_rules?(Object(r["q"])(),Object(r["d"])(u,{key:1,deleteSelected:c.board.selected&&c.deleteSelected},null,8,["deleteSelected"])):Object(r["e"])("",!0),c.board.error?(Object(r["q"])(),Object(r["d"])("div",{key:2,class:c.css.alert.danger()},[Object(r["g"])("i",{class:c.css.icon("times-circle text-xl mr-2")},null,2),Object(r["f"])(" "+Object(r["A"])(c.board.error),1)],2)):(Object(r["q"])(),Object(r["d"])("div",{key:3,class:c.css.alert.info()},[Object(r["g"])("div",null,[Object(r["f"])(Object(r["A"])(c.turn_text)+" ",1),Object(r["g"])(p,{time:c.board.last_move_at},null,8,["time"])])],2))],2)])}var Vn=n("9a0e"),Zn=(n("a434"),n("4de4"),n("a05f")),Qn=n("d4ec"),Xn=n("bee2"),er=n("ade3"),tr=function(e,t){return(e%t+t)%t},nr={},rr=function(e){var t="".concat(e.W,",").concat(e.H);return nr[t]||(nr[t]=new or(e,t)),nr[t]},or=function(){function e(t){var n=this;if(Object(Qn["a"])(this,e),Object(er["a"])(this,"xy2index",(function(e){return e[0]+n.W*e[1]})),Object(er["a"])(this,"index2xy",(function(e){return[e%n.W,Math.floor(e/n.W)]})),Object(er["a"])(this,"preCache",(function(){n.indexes=Object(Zn["range"])(n.AREA),n.dindexes={0:[-1,-n.W,1,n.W+1,n.W,n.W-1],1:[-n.W-1,-n.W,1-n.W,1,n.W,-1],dragonfly:{0:[-n.W-1,1-n.W,2,-2,2*n.W+1,2*n.W-1]},short:{0:{},1:{}}},n.short_dirs=["ul","u","ur","dr","d","dl"],n.short_dirs.forEach((function(e,t){n.dindexes.short[0][e]=n.dindexes[0][e]=n.dindexes[0][t],n.dindexes.short[1][e]=n.dindexes[1][e]=n.dindexes[1][t]})),n.dindexes.dragonfly[1]=n.dindexes.dragonfly[0].map((function(e){return-1*e})),n.touching={},n.short_dindexes={},n.indexes.forEach((function(e){n.touching[e]=n.dindexes[tr(e,2)].map((function(t){return e+t}))}))})),!t.W||!t.H)throw"Geo requires a width and height (constructor options W and H)";this.setSize(t),this.element=t.element}return Object(Xn["a"])(e,[{key:"setSize",value:function(e){var t=e.W,n=e.H;this.W=t,this.H=n,this.WH="".concat(t,",").concat(n),this.AREA=t*n,this.preCache(),this.center=this.xy2index([Math.floor(this.W/2),Math.floor(this.H/2)]),this.center-=1}}]),e}(),ar=n("db5a"),cr=n.n(ar),ir=(n("d3b7"),n("6062"),n("ddb0"),function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;"number"===typeof t&&(t=[t]),t=t.filter((function(t){return e.stacks[t]&&e.stacks[t].length<=n}));var r=0,o={};return Object.keys(e.stacks).forEach((function(n){var a;(n=parseInt(n),t.includes(n))||(e.geo.touching[n].forEach((function(e){if(!t.includes(e)){var n=o[e];n&&n!==a&&(a?Object.entries(o).forEach((function(e){var t=Object(H["a"])(e,2),r=t[0],c=t[1];c===n&&(o[r]=a)})):a=n)}})),a||(r++,a=r),o[n]=a)})),new Set(Object.values(o)).size>1}),sr=(n("c1f9"),{fly:["fly","wasp","ladybug","cockroach","grasshopper","cicada","lanterfly"],crawl:["ant","cicada"],stack:["beetle","orchid_mantis","praying_mantis","fly","dragonfly"]}),lr={};Object.entries(sr).forEach((function(e){var t=Object(H["a"])(e,2),n=t[0],r=t[1];r.forEach((function(e){lr[e]=lr[e]||[],lr[e].push(n)}))}));var ur={scorpion:function(e,t){e.layers.stack[t]=!0},orbweaver:function(e,t){e.layers.fly[t]=!0},trapdoor_spider:function(e,t){e.geo.touching[t].forEach((function(n){e.layers.crawl[n]=e.layers.crawl[n]||[],e.layers.crawl[n].push(parseInt(t))}))},no:{fly:function(e,t){return!e.layers.fly[t]},crawl:function(e,t){return!e.layers.crawl[t]},stack:function(e,t){return!e.layers.stack[t]}},getVisible:function(e,t){var n=e.layers.type[t];return"fly"===n?[1===e.stacks[t].length?"stack":"fly"]:lr[n]||[]},title:{crawl:function(e){return"The ".concat(e," get stuck in the trapdoor_spiders web.")},"crawl-gray":function(e){return"Since the ".concat(e," started in this web, it cannot be stuck on it again.")},stack:function(e){return"The ".concat(e," cannot step on top of the scorpion.")},fly:function(e){return"The ".concat(e," cannot move over the orbweaver.")}}},pr=function(e,t,n){var r=e.layers,o=r.stack,a=r.player;return!o[n]||a[t]===a[n]},dr=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(0===e.turn)return[e.geo.center];if(1===e.turn)return[e.geo.center+1];t=parseInt(t);var r=1===t?2:1,o={1:{},2:{}};return Object.entries(e.stacks).forEach((function(t){var r=Object(H["a"])(t,2),a=r[0],c=r[1],i=Object(Zn["last"])(c);if(a=parseInt(a),!n.includes(a)){var s=e.piece_owners[i];e.geo.touching[a].forEach((function(t){e.stacks[t]||(o[s][t]=!0)}))}})),Object.keys(o[t]).filter((function(e){return!o[r][e]})).map((function(e){return parseInt(e)}))},hr=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=e.geo.touching[t];return r.filter((function(t,o){if(e.stacks[t]||n.includes(t))return!1;var a=0,c=r[tr(o-1,r.length)],i=r[tr(o+1,r.length)];return!n.includes(c)&&e.stacks[c]&&a++,!n.includes(i)&&e.stacks[i]&&a++,1===a}))},fr=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=e.geo.touching[t];return r.filter((function(r){return e.stacks[r]&&!n.includes(r)&&pr(e,t,r)}))},br=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=e.geo.touching[t];return r.filter((function(t){return!e.stacks[t]&&!n.includes(t)}))},mr=function(e,t){var n={stacks:{},geo:e.geo};Object.keys(e.stacks).filter((function(e){return parseInt(e)!==t})).forEach((function(t){return n.stacks[t]=e.stacks[t]}));var r={},o=[t];while(o.length){var a=o.pop();r[a]=hr(n,a),r[a].filter((function(e){return!r[e]})).forEach((function(e){return o.push(e)}))}return r},vr=function e(t,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=t[n].filter((function(e){return!o.includes(e)}));return 1===r?a:Object(Zn["flatten"])(a.map((function(a){return e(t,a,r-1,[].concat(Object(N["a"])(o),[n]))})))},gr=function(e,t,n){var r=mr(e,t);return vr(r,t,n)},yr=function(e,t,n){var r=e.layers.crawl[n];if(!r)return!1;var o=e.layers.crawl[t]||[],a=e.layers.player[t];return void 0!==r.find((function(t){return e.layers.player[t]!==a&&!o.includes(t)}))},_r=function(e,t){var n=mr(e,t),r={},o={},a=[t],c=[],i=function(){var i=a.shift();if(r[i])return"continue";r[i]=!0,n[i].filter((function(e){return!r[e]})).forEach((function(n){o[i]?o[n]=!0:(yr(e,t,n)&&(o[n]=!0),c.push(n)),a.push(n)}))};while(a.length)i();return c},Or=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=[];return e.geo.touching[t].map((function(t,o){if(e.stacks[t]){while(e.stacks[t]){if(e.layers.fly[t])return;if(n.includes(t))return;var a=e.geo.dindexes[tr(t,2)][o];t+=a}r.push(t)}})),r},wr=function(e,t){var n=[t],r=[];while(n.length){var o=n.pop();Or(e,o,[t]).filter((function(e){return!r.includes(e)})).forEach((function(o){r.push(o),yr(e,t,o)||n.push(o)}))}return r},jr=function(e,t){var n=function(t){return!e.layers.fly[t]},r=[];return fr(e,t).filter(n).forEach((function(o){return fr(e,o,[t]).filter(n).forEach((function(n){return r=r.concat(br(e,n,[t]))}))})),r},kr=function(e,t){if(e.stacks[t].length>1)return br(e,t);var n=function(t){return!e.layers.fly[t]},r=[];return fr(e,t).filter(n).forEach((function(n){return r=r.concat(fr(e,n,[t]))})),r.filter((function(n){return pr(e,t,n)}))},xr=function(e,t){return 1===e.stacks[t].length?hr(e,t):Cr(e,t)},qr=function(e,t){return e.stacks[t].length>1?br(e,t):[]},Er=function(e,t){return e.stacks[t].length>1?Cr(e,t):[]},Cr=function(e,t){return e.stacks[t].length>1?br(e,t).concat(fr(e,t)):hr(e,t).concat(fr(e,t))},Tr=function(e,t,n){var r=[];e.stacks[t].length>1&&r.push(t);var o=[t],a={};while(o.length){var c=o.pop();a[c]=!0,e.geo.touching[c].forEach((function(t){!a[t]&&e.stacks[t]&&(n.find((function(n){return!n(e,t)}))||(o.push(t),r.push(t)))}))}return r},Hr=function(e){return function(t,n){var r=Object(Zn["last"])(t.stacks[n]);return t.piece_owners[r]===e}},Ar=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return!0},r=[];return t.forEach((function(t){br(e,t).forEach((function(t){n(e,t)&&!r.includes(t)&&r.push(t)}))})),r},Ir=function(e,t){var n=e.piece_owners[Object(Zn["last"])(e.stacks[t])],r=Tr(e,t,[ur.no.fly,Hr(n)]);return Ar(e,r).filter((function(e){return e!==t}))},Wr=function(e,t){var n=Tr(e,t,[ur.no.fly]);return Ar(e,n).filter((function(e){return e!==t}))},Pr=function(e,t){return e.stacks[t].length>1?Wr(e,t):fr(e,t)},Sr=function(e,t){var n=e.geo.touching[t].filter((function(t){return e.stacks[t]}));return n.length<3?hr(e,t):Wr(e,t)},$r=function(e,t){var n={},r=Object.keys(e.stacks).filter((function(e){return parseInt(e)!==t}));r.forEach((function(t){e.geo.touching[t].filter((function(t){return!e.stacks[t]})).forEach((function(e){n[e]=(n[e]||0)+1}))}));var o=Wr(e,t).filter((function(e){return n[e]>=3}));return hr(e,t).concat(o)},Nr=function(e,t){var n=e.piece_owners[Object(Zn["last"])(e.stacks[t])],r=Tr(e,t,[ur.no.fly]),o=dr(e,1===n?2:1,[t]);return Ar(e,r).filter((function(e){return o.includes(e)}))},Mr=function(e,t){return 1===e.stacks[t].length?hr(e,t):[]},Fr=function(e,t){return hr(e,t)},Gr=function(e,t){var n=gr(e,t,3);return e.geo.dindexes[tr(t,2)].forEach((function(r,o){var a=t+r;if(e.stacks[a]&&"orbweaver"!==e.layers.type[a]){var c=a+e.geo.dindexes[tr(a,2)][o];e.stacks[c]||n.push(c)}})),n},Rr=function(e,t){return e.stacks[t].length>1?Cr(e,t):[]},Lr={stepOnHive:fr,stepOffHive:br,centipede:Fr,queen:hr,pill_bug:hr,earthworm:hr,ant:_r,beetle:Cr,cockroach:Ir,dragonfly:function(){return[]},damselfly:Mr,grasshopper:Or,cicada:wr,fly:Pr,lanternfly:Sr,lanternfly_nymph:$r,wasp:Nr,getPlacement:dr,ladybug:jr,orchid_mantis:xr,praying_mantis:qr,mosquito:Er,spider:Gr,scorpion:Gr,trapdoor_spider:Gr,orbweaver:Gr,emerald_wasp:kr,kung_fu_mantis:Rr},Ur=Lr,zr=function(e,t,n){e.selected&&(e.selected.chalk=Object.fromEntries(t.map((function(e){return[e,n]}))))},Dr=function(e,t,n,r){return e.stacks[n]=e.stacks[n]||[],e.stacks[n].push(e.stacks[t].pop()),{from:t,to:n,special:r}},Jr=function(e,t){return e.geo.touching[t].filter((function(t){return e.stacks[t]&&!ir(e,t)}))},Kr=function(e,t,n){var r=e.reverse[t];return 0===n.length?Jr(e,r):1===n.length?e.geo.touching[r].filter((function(t){return!e.stacks[t]})):function(){return Dr(e,n[0],n[1],r)}},Br=function(e,t,n){return e.stacks[t].unshift(e.stacks[n].pop()),{from:n,to:t,stacks:[t,n]}},Yr=function(e,t,n){var r=e.reverse[t];if(e.stacks[r].length>1)return[];if(1===n.length)return function(){return Br(e,r,n[0])};var o=Jr(e,r).filter((function(t){return pr(e,r,t)}));return zr(e,o,(function(e){return e+" purple-inner"})),o},Vr=function(e,t,n){var r=e.reverse[t];if(e.stacks[r].length>1)return[];if(1===n.length)return function(){return Br(e,r,n[0])};var o=e.geo.dindexes,a=o[0].map((function(e,t){return r+e+o[1][t]}));return a.filter((function(t){return e.stacks[t]})).filter((function(t){return!ir(e,[t,r])})).filter((function(t){return pr(e,r,t)}))},Zr=function(e,t,n){var r=e.reverse[t];if(e.stacks[r].length>1||ir(e,[r]))return[];var o=[];if(e.geo.touching[r].map((function(t,n){var r,a;if(e.stacks[t]){while(e.stacks[t]){if(void 0!==a&&e.layers.fly[a])return;var c=e.geo.dindexes[tr(t,2)][n];a=t,!r&&e.stacks[t].length>1&&(r=t),t+=c}o.push([a,r])}})),0===n.length){var a=[];return o.filter((function(e){return void 0!==e[1]})).map((function(e){return a=a.concat(e)})),zr(e,a,(function(e){return e+" purple-inner"})),o.filter((function(t){return!e.layers.stack[t[0]]})).map((function(e){return e[0]}))}return function(){var t=o.find((function(e){return e[0]===n[0]})),a=Object(H["a"])(t,2),c=a[0],i=a[1],s=[c,r];return e.stacks[i]&&(s.push(i),e.stacks[c].push(e.stacks[i].pop()),n.push(i)),e.stacks[c].push(e.stacks[r].pop()),{from:r,to:c,stacks:s}}},Qr=function(e,t,n){var r=e.stacks[t].pop(),o=e.stacks[n].pop();e.stacks[t].push(o),e.stacks[n].push(r)},Xr=function(e,t,n){var r=e.stacks[t].shift(),o=e.stacks[n].shift();e.stacks[t].unshift(o),e.stacks[n].unshift(r)},eo=function(e,t,n){var r=e.reverse[t];if(0===n.length){var o=[];return fr(e,r).forEach((function(t){return fr(e,t,[r]).forEach((function(n){return o=o.concat(fr(e,n,[r,t]))}))})),o.filter((function(t){return!ir(e,[r,t])}))}return function(){return Xr(e,r,n[0]),{from:r,to:n[0],stacks:[n[0]]}}},to=function(e,t,n){var r=e.reverse[t];if(0===n.length){var o=e.geo.touching[r];return o.filter((function(t,n){if(!e.stacks[t]||e.stacks[t].length>1)return!1;var a=e.stacks[o[tr(n-1,6)]],c=e.stacks[o[tr(n+1,6)]];return(!a||!c)&&!ir(e,[r,t])}))}return function(){return Qr(e,r,n[0]),{from:r,to:n[0]}}},no=function(e,t,n){var r=e.reverse[t];return e.stacks[r].length>1?ro(e,t,n):n.length>0?function(){return n.push("pulled"),Br(e,r,n[0])}:e.geo.dindexes.dragonfly[tr(r,2)].map((function(e){return r+e})).filter((function(t){return e.stacks[t]})).filter((function(t){return pr(e,r,t)})).filter((function(t){return!ir(e,[t])}))},ro=function(e,t,n){var r=function(e,t,n){return e.stacks[t].length>1&&!e.stacks[n]&&!ir(e,[t],2)},o=e.reverse[t],a=tr(o,2);if(0===n.length){var c=function(t){return pr(e,o,t)},i=e.geo.dindexes.dragonfly[a].map((function(e){return o+e})).filter(c);return zr(e,i.filter((function(t){return r(e,o,t)})),(function(e){return e+" purple-inner"})),i}return function(){var t=n[0],a={from:o,to:t};return r(e,o,t)?(e.stacks[t]=e.stacks[o].splice(-2,2),n.push(!0),a.stacks=[o,t]):Dr(e,o,t),a}},oo=function(e,t,n){var r=e.reverse[t];if(e.stacks[r].length>1)return[];var o=function(e,t){return"mosquito"!==e.piece_types[Object(Zn["last"])(e.stacks[t])]},a=e.geo.touching[r].filter((function(t){return e.stacks[t]&&o(e,t)}));if(0===n.length)return a;if("move"===n[0])return function(){return Dr(e,r,n[1])};if("string"===typeof n[0])return io[n[0]](e,t,n[1]);var c=n[0],i=Object(Zn["last"])(e.stacks[c]),s=e.piece_types[i],l=Ur[s](e,r);if(2===n.length&&l.includes(n[1]))return function(){n[0]="move",Dr(e,r,n[1])};var u=io[s],p=n.slice(1),d=u?u(e,t,p):[];return 1===n.length?(zr(e,l,(function(e){return e.replace("yellow","")+" green"})),l.concat(d||[])):"function"===typeof d?function(){var e=d();while(n.length)n.pop();return n.push(s),n.push(p),e}:d},ao=function(e,t,n,r){var o=Object(H["a"])(r,2),a=o[0],c=o[1];e.stacks[n]=e.stacks[n]||[],c?e.stacks[n]=e.stacks[n].concat(e.stacks[a].splice(-2,2)):e.stacks[n].push(e.stacks[a].pop())},co=function(e,t,n,r){var o=e.stacks[n].shift();e.stacks[r[0]]=e.stacks[r[0]]||[],e.stacks[r[0]].push(o)},io={move:Dr,selectNearby:Jr,dragonfly:ro,damselfly:ro,dragonfly_nymph:no,pill_bug:Kr,orchid_mantis:Yr,praying_mantis:Zr,centipede:to,mosquito:oo,earthworm:eo,kung_fu_mantis:Vr,undo:{mosquito:function(e,t,n,r){"move"===r[0]?Dr(e,r[1],n):io.undo[r[0]](e,t,n,r[1])},earthworm:function(e,t,n,r){return Xr(e,r[0],n)},pill_bug:function(e,t,n,r){return Dr(e,r[1],r[0])},centipede:function(e,t,n,r){return Qr(e,r[0],n)},orchid_mantis:co,kung_fu_mantis:co,praying_mantis:function(e,t,n,r){var o=Object(H["a"])(r,2),a=o[0],c=o[1];Dr(e,a,n),void 0!==c&&Dr(e,a,c)},dragonfly:ao,dragonfly_nymph:function(e,t,n,r){var o="pulled"===r[1]?co:ao;return o(e,t,n,r)},damselfly:ao}},so=io,lo={},uo=2,po=function(){return[]},ho={moves:Ur,specials:so,wouldBreakHive:ir,PLAYER_COUNT:uo,getHash:function(e){return cr()(Object(Zn["pick"])(e,["stacks","piece_types","piece_owners","current_player"]))},update:function(e){if(window.b=e,!e.reverse||ho.getHash(e)!==e.hash){var t;e.layers={type:{},player:{},stack:{},crawl:{},fly:{}},e.special_args=e.special_args||[],e.actions=e.actions||[],e.player_list=[1,2],e.reverse={},e.geo=rr(e),Object.entries(e.stacks).forEach((function(t){var n=Object(H["a"])(t,2),r=n[0],o=n[1];if(o&&0!==o.length){o.forEach((function(t){e.reverse[t]=parseInt(r),e.layers.type[r]=e.piece_types[t],e.layers.player[r]=e.piece_owners[t]}));var a=e.layers.type[r];ur[a]&&ur[a](e,r)}else delete e.stacks[r]})),e.hash=ho.current_hash=ho.getHash(e),ho._markBoard(e),Object.values(e.stacks).forEach((function(n){var r=n[n.length-1];e.piece_owners[r]===e.current_player&&(0===ho.getMoves(e,r).length&&0===ho.getSpecials(e,r,[]).length||(t=!0))}));var n=ho.moves.getPlacement(e,e.current_player).length>0;n||t||(e.error="Skipped player ".concat(e.current_player,"'s turn because there are no legal moves"),ho.nextPlayer(e)),ho.checkWinner(e)}},_markBoard:function(e){e.onehive={},e.cantmove={},e.empty={},e.queens={},Object.entries(e.stacks).forEach((function(t){var n=Object(H["a"])(t,2),r=n[0],o=n[1];r=parseInt(r);var a=Object(Zn["last"])(o),c=e.piece_types[a];ir(e,r)&&(e.onehive[r]=!0,e.cantmove[r]=!0),["orchid_mantis","kung_fu_mantis","dragonfly_nymph"].includes(c)&&(ho.getSpecials(e,a,[]).length>0?delete e.cantmove[r]:0===ho.getMoves(e,a).length&&(e.cantmove[r]=!0)),"pill_bug"===c&&e.cantmove[r]&&ho.getSpecials(e,a,[]).length>0&&delete e.cantmove[r],e.geo.touching[r].forEach((function(t){e.stacks[t]||(e.empty[t]=!0)}))})),e.piece_types.forEach((function(t,n){"queen"===t&&(e.queens[e.piece_owners[n]]=e.reverse[n])})),0===Object.keys(e.empty).length&&(e.empty[e.geo.center]=!0)},get:function(e){var t=lo[e];return t&&(lo[e]=t,ho.update(t)),t},_delete:function(e){return delete lo[e]},getUrl:function(e){return"local"!==e.room_id&&e.room_id?"#/play/".concat(e.room_id,"/"):"#/local/"},nextPlayer:function(e){e.current_player++,e.current_player>e.player_list.length&&(e.current_player=1)},prevPlayer:function(e){e.current_player--,e.current_player<e.player_list[0]&&(e.current_player=e.player_list[e.player_list.length-1])},nextTurn:function(e){delete e.frozen;var t=e.actions[e.actions.length-1];e.turn++;var n=t&&"toggleCheat"===t[0];n||(ho.nextPlayer(e),e.last_move_at=(new Date).valueOf()),ho.unselect(e),ho.update(e)},doAction:function(e,t){var n=t[0],r=t[1];if("toggleCheat"===n)e.rules.no_rules=!e.rules.no_rules;else if("place"===n){var o=e.piece_types.length,a=t[2],c=t[3];e.piece_types.push(a),e.piece_owners.push(c),e.stacks[r]=e.stacks[r]||[],e.stacks[r].push(o),e.last={to:r}}else if("special"===n){var i=t[2],s=t[3],l=ho.getSpecials(e,i,s);if("function"!==typeof l)throw"Attempting to doAction on an incomplete special";e.last=l()}else{var u=t[2],p=Object(Zn["last"])(e.stacks[r]);e.stacks[r].pop(),e.stacks[u]=e.stacks[u]||[],e.stacks[u].push(p),e.last={from:r,to:u}}e.actions.push(t),ho.nextTurn(e)},json_fields:["actions","id","W","H","stacks","piece_types","piece_owners","hash","turn","rules","winner","players","host","last","room_id","current_player","last_move_at","game_id"],toJson:function(e){return Object(Zn["cloneDeep"])(Object(Zn["pick"])(e,ho.json_fields))},fromJson:function(e){return ho.update(e),e},new:function(e){var t=Object(ge["a"])(Object(ge["a"])({W:50,H:50},e),{},{piece_types:[],piece_owners:[],turn:0,actions:[],current_player:1,last_move_at:(new Date).valueOf()});return t.hash=ho.getHash(t),t.stacks={},ho.update(t),t},getSpecials:function(e,t,n){var r=e.piece_types[t],o=so[r]||po;return o(e,t,n)},getMoves:function(e,t){var n=e.reverse[t],r=e.piece_types[t];if(ir(e,n))return[];var o=Ur[r]||po;return o(e,n)},unselect:function(e){ho.update(e),e.hash=ho.getHash(e),e.special_args=[],delete e.selected,delete e.error},select:function(e,t){var n=e.selected,r=void 0===n?{}:n;ho.unselect(e);var o=r.piece_id===t.piece_id&&r.piece_type===t.piece_type;void 0===t.piece_id||o||(e.cantmove[t.index]&&(e.error="Moving this piece would break the hive."),e.selected=Object(Zn["pick"])(t,["player_id","piece_id","piece_type","index"]))},freeze:function(e){e.frozen=e.frozen||ho.toJson(e)},undo:function(e){if(0!==e.actions.length){delete e.last,ho.freeze(e);var t=e.actions.pop();if("special"===t[0]){var n=Object(H["a"])(t,4),r=(n[0],n[1]),o=n[2],a=n[3],c=e.piece_types[o];so.undo[c](e,o,r,a)}else if("place"===t[0])e.piece_types.pop(),e.piece_owners.pop(),e.stacks[t[1]].pop();else{var i=Object(H["a"])(t,3),s=(i[0],i[1]),l=i[2];so.move(e,l,s)}e.turn--,ho.prevPlayer(e),ho.update(e)}},redo:function(e){var t=e.frozen;t&&t.actions.length!==e.turn&&(ho.doAction(e,e.frozen.actions[e.turn]),e.frozen=t)},isUsersTurn:function(e){return!e.players||e.current_player===e.local_player},click:function(e,t){var n=e.rules,r=e.selected,o=r||{},a=o.player_id,c=o.piece_type;if(r&&n.no_rules&&void 0!==t.index)"new"===r.piece_id?ho.doAction(e,["place",t.index,c,a]):ho.doAction(e,["move",r.index,t.index]);else if(r&&a===e.current_player&&"new"!==t.piece_id&&!e.cantmove[r.index]&&ho.isUsersTurn(e))if("new"!==r.piece_id){var i=ho.getSpecials(e,r.piece_id,e.special_args);if(i.includes(t.index)){if(e.special_args.push(t.index),i=ho.getSpecials(e,r.piece_id,e.special_args),"function"===typeof i){var s=e.reverse[r.piece_id];ho.doAction(e,["special",s,r.piece_id,e.special_args])}}else{var l=ho.getMoves(e,r.piece_id);l.includes(t.index)?ho.queenCheck(e)?e.queens[e.current_player]?ho.doAction(e,["move",r.index,t.index]):e.error="You cannot move any piece before placing your queen":e.error="You must place your queen before the 4th turn":ho.select(e,t)}}else{var u=ho.moves.getPlacement(e,a);u.includes(t.index)?ho.queenCheck(e)&&ho.doAction(e,["place",t.index,c,a]):ho.select(e,t)}else ho.select(e,t)},error:function(e,t){e.error=t},queenCheck:function(e){if("queen"===e.selected.piece_type||e.rules.no_rules)return!0;var t=6===e.turn&&void 0===e.queens[1],n=7===e.turn&&void 0===e.queens[2];return!t&&!n||(ho.error(e,"You must place your queen on or before the 4th turn"),!1)},deletePiece:function(e,t){e.piece_types.splice(t,1),e.piece_owners.splice(t,1),Object.entries(e.stacks).forEach((function(e){var n=Object(H["a"])(e,2),r=(n[0],n[1]);r.forEach((function(e,n){e===t&&r.splice(n,1)})),r.forEach((function(e,n){e>t&&(r[n]-=1)}))})),ho.unselect(e),ho.update(e)},checkWinner:function(e){if(void 0===e.winner){var t=e.player_list.filter((function(t){var n=e.queens[1===t?2:1];return void 0!==n&&6===e.geo.touching[n].filter((function(t){return e.stacks[t]})).length}));e.winner=2===t.length?"tie":t[0]}}},fo=ho,bo=function(e,t,n){return"piece hex-player_".concat(e," type type-").concat(t," hex -stacked-").concat(n)},mo=function(e,t){var n="piece hex";if(!e.empty[t])return n;var r=["r","g","b","r"],o=e.geo.index2xy(t)[1]%3+t%2;return n+" hex-empty_"+r[o]},vo=function(e){var t=-1/0,n=-1/0,r=1/0,o=1/0,a=Object.keys(e.stacks);return 0===a.length&&a.push(e.geo.center),a.map((function(e){return parseInt(e)})).forEach((function(a){var c=e.geo.index2xy(a);t=Math.max(t,c[0]+1),n=Math.max(n,c[1]+1),r=Math.min(r,c[0]-1),o=Math.min(o,c[1]-1)})),r%2!==0&&(r-=1),Object(Zn["range"])(o,n+1).map((function(n){return Object(Zn["range"])(r,t+1).map((function(t){return{index:e.geo.xy2index([t,n]),xy:[t,n]}}))}))},go=function(e,t){var n=e.stacks[t];return n?n.map((function(t,r){n.length>4&&(r=r-n.length+4);var o=e.piece_types[t],a=e.piece_owners[t];return bo(a,o,r)})):[mo(e,t)]},yo=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.columns,r=void 0===n?1:n,o=Oo(e),a=e.selected,c=void 0===a?{}:a;if(void 0!==c.index)o[c.index]=" purple";else if("new"!==c.piece_id&&e.last){var i;e.last.from&&(o[e.last.from]=" blue-dashed"),e.last.to&&(o[e.last.to]=" blue"),e.last.special&&(o[e.last.special]=" yellow"),null===(i=e.last.stacks)||void 0===i||i.forEach((function(e){o[e]+=" purple-inner"}))}var s=ur.getVisible(e,c.index),l=vo(e);l.forEach((function(t){return t.forEach((function(t){t.stack=go(e,t.index),t.selected=t.index===c.index;var n=e.stacks[t.index];if(n){var r=n[n.length-1];t.piece_id=r,t.player_id=e.piece_owners[r],t.piece_type=e.piece_types[r]}if(s.forEach((function(n){if(e.layers[n][t.index]&&("stack"!==n||c.player_id!==e.layers.player[t.index])){if("crawl"===n){if(e.stacks[t.index]&&t.index!==c.index)return;var r=e.layers[n][t.index].filter((function(t){return c.player_id!==e.layers.player[t]}));if(0===r.length)return;var o=e.layers.crawl[c.index]||[];void 0!==r.find((function(e){return o.includes(e)}))&&(n="crawl-gray")}t.title=ur.title[n](c.piece_type),t.web=n}})),o[t.index]){var a=t.stack.length-1;t.stack[a]=t.stack[a]+o[t.index]}}))}));var u={1:[],2:[]};return it.getAvailable(e).forEach((function(e){var t=e.player_id,n=e.type,r=e.count;t=parseInt(t);var o={stack:Object(Zn["range"])(r).map((function(e){return bo(t,n,e)})),player_id:t,piece_id:"new",piece_type:n,type:"cell"};if("new"===c.piece_id&&c.piece_type===n&&t===c.player_id){var a=o.stack.length-1;o.stack[a]=o.stack[a]+" purple"}u[t].push(o)})),{rows:l,player_1:_o(u[1],r),player_2:_o(u[2],r)}},_o=function(e,t){var n=[],r=[];n.push(r);while(e.length)r.push(e.shift()),r.length===t&&(r=[],n.push(r));return n},Oo=function(e){var t=e.selected,n={};if(Object.keys(e.cantmove).forEach((function(e){return n[e]=" gray"})),!t)return n;var r=t.piece_id,o=t.player_id,a=e.current_player===o?" green":" red",c=[];if("new"===r)c=fo.moves.getPlacement(e,o);else{var i=fo.getSpecials(e,r,e.special_args);i.forEach((function(e){return n[e]=" yellow"})),0===e.special_args.length&&(c=fo.getMoves(e,r)),t.chalk&&Object.entries(t.chalk).forEach((function(e){var t=Object(H["a"])(e,2),r=t[0],o=t[1];return n[r]=o(n[r]||"")}))}return c.forEach((function(e){return n[e]=a})),n};function wo(e,t,n,o,a,c){return Object(r["q"])(),Object(r["d"])("div",{class:c.css.root,style:c.css.style},[(Object(r["q"])(!0),Object(r["d"])(r["a"],null,Object(r["u"])(n.rows,(function(t,n){return Object(r["q"])(),Object(r["d"])("div",{key:n,class:"row"},[(Object(r["q"])(!0),Object(r["d"])(r["a"],null,Object(r["u"])(t,(function(t,n){return Object(r["q"])(),Object(r["d"])("div",{key:n,class:c.css.cell(t)},[Object(r["g"])("div",{class:"content","data-web":t.web,title:t.title},[(Object(r["q"])(!0),Object(r["d"])(r["a"],null,Object(r["u"])(t.stack,(function(n,o){return Object(r["q"])(),Object(r["d"])("div",{key:o,onClick:function(n){return e.$emit("clickPiece",t)},class:n,"data-index":t.index,"data-xy":t.xy,"data-piece_id":t.piece_id},null,10,["onClick","data-index","data-xy","data-piece_id"])})),128))],8,["data-web","title"])],2)})),128))])})),128))],6)}var jo={props:{rows:Array},emits:["clickPiece"],computed:{css:function(){var e=this.$store.config.state,t=e.theme,n=e.hex_angle,r=e.zoom;return{root:"zoom-".concat(r," hex-grid hex-").concat(n," theme-").concat(t),style:{"--columns":this.rows[0].length},cell:function(e){var t=e.selected;return["item",{selected:t}]},tile:function(e,t){return t}}}}};jo.render=wo;var ko=jo,xo={key:0,class:"fixed left-0 bottom-0 m-4 HelpText"},qo={key:1,class:"fixed left-0 bottom-0 m-4 HelpText"},Eo={key:2,class:"fixed left-0 bottom-0 HelpText"},Co={class:"browser-default"};function To(e,t,n,o,a,c){return c.show_help?n.board.selected?(Object(r["q"])(),Object(r["d"])("div",Eo,[Object(r["g"])("div",{class:c.css.alert.info()},[Object(r["g"])("div",null,[Object(r["g"])("ul",Co,[(Object(r["q"])(!0),Object(r["d"])(r["a"],null,Object(r["u"])(c.items,(function(e){return Object(r["q"])(),Object(r["d"])("li",{key:e},Object(r["A"])(e),1)})),128))]),Object(r["g"])("div",null,[Object(r["g"])("button",{onClick:t[2]||(t[2]=function(){return c.unselect&&c.unselect.apply(c,arguments)}),class:c.css.button("mr-2")}," Deselect ",2),Object(r["g"])("button",{onClick:t[3]||(t[3]=function(){return c.toggle&&c.toggle.apply(c,arguments)}),class:c.css.button()}," Hide Help ",2)])])],2)])):(Object(r["q"])(),Object(r["d"])("div",qo,[Object(r["g"])("div",{class:c.css.alert.info()},"Select a Tile",2)])):(Object(r["q"])(),Object(r["d"])("div",xo,[Object(r["g"])("div",{onClick:t[1]||(t[1]=function(){return c.toggle&&c.toggle.apply(c,arguments)}),class:c.css.button("circle")},[Object(r["g"])("i",{class:c.css.icon("question")},null,2)],2)]))}var Ho="PLACEMENT: Place this piece in any empty space that only touches friendly tiles. After placed, this pieces moves are:",Ao={props:{board:Object},computed:{css:function(){return b.a},show_help:function(){return this.$store.config.state.show_help},items:function(){var e=this.board,t=e.selected,n=t.piece_id,r=t.piece_type,o=Xe[r].map((function(t){return"function"===typeof t?t(e):t}));return"new"===n&&o.unshift(Ho),o}},methods:{unselect:function(){fo.unselect(this.board)},toggle:function(){this.$store.config.save({show_help:!this.show_help})}}};Ao.render=To;var Io=Ao,Wo={key:0};function Po(e,t,n,o,a,c){return n.deleteSelected?(Object(r["q"])(),Object(r["d"])("div",Wo,[Object(r["g"])("button",{class:a.css.button.error(),onClick:t[1]||(t[1]=function(){return n.deleteSelected&&n.deleteSelected.apply(n,arguments)})}," Delete selected ",2)])):(Object(r["q"])(),Object(r["d"])("span",{key:1,onClick:t[2]||(t[2]=function(){return c.click&&c.click.apply(c,arguments)}),class:a.css.alert.warning("cursor-pointer")}," ¯\\_(ツ)_/¯ No Rules ",2))}var So={props:{deleteSelected:Function},data:function(){return{css:b.a,open:!1}},methods:{click:function(){this.$ui.alert({title:"No Rules Mode",text:"This game was created with rules off. The board will still display legal moves for a selected piece, but pieces can be moved anywhere whether the rules allow it or not."})}}};So.render=Po;var $o=So;function No(e,t,n,o,a,c){return Object(r["q"])(),Object(r["d"])("span",null,Object(r["A"])(a.text),1)}n("4d90"),n("25f0");var Mo=function(e){return e.toString().padStart(2,"0")},Fo={props:{time:Number},data:function(){return{text:"00:00",timeout:null}},mounted:function(){this.timeout=setTimeout(this.step,1e3)},unmounted:function(){clearTimeout(this.timeout)},methods:{step:function(){clearTimeout(this.timeout),this.tick++,this.timeout=setTimeout(this.step,this.tick>60?6e4:1e3);var e=Math.floor(((new Date).valueOf()-this.time)/1e3);if(!isNaN(this.time)){var t=e%60,n=Math.floor(e/60);this.text="".concat(Mo(n),":").concat(Mo(t))}}}};Fo.render=No;var Go=Fo;function Ro(e,t,n,o,a,c){var i=Object(r["w"])("unrest-modal");return Object(r["q"])(),Object(r["d"])(r["a"],null,[Object(r["g"])("div",{class:a.css.alert.info("cursor-pointer"),onClick:t[1]||(t[1]=function(e){return a.open=!0})},Object(r["A"])(c.text),3),a.open?(Object(r["q"])(),Object(r["d"])(i,{key:0,class:"text-center",close:function(){return a.open=!1}},{actions:Object(r["F"])((function(){return[Object(r["g"])("button",{class:a.css.button(),onClick:t[2]||(t[2]=function(e){return a.open=!1})}," Keep Playing ",2),c.can_end?(Object(r["q"])(),Object(r["d"])("button",{key:0,class:a.css.button(),onClick:t[3]||(t[3]=function(e){return c.send("reset_game")})}," Play Again ",2)):Object(r["e"])("",!0)]})),default:Object(r["F"])((function(){return[Object(r["g"])("h2",null,Object(r["A"])(c.text),1)]})),_:1},8,["close"])):Object(r["e"])("",!0)],64)}var Lo={props:{board:Object,room:Object},data:function(){return{open:!0,css:b.a}},computed:{text:function(){var e=this.board.winner;return"tie"===e?"The game is a draw":"Player ".concat(e," has won the game.")},can_end:function(){return this.$store.room.isHost(this.room.id)}},methods:{send:function(e){this.$store.room.send(this.room.id,e)}}};Lo.render=Ro;var Uo=Lo;Vn["a"].register({cancel:"esc",undo:"mod+z",redo:"mod+y,mod+shift+z",help:"?,/"});var zo={components:{HelpText:Io,HiveBoard:ko,NoRules:$o,TimeSince:Go,Winner:Uo},mixins:[Vn["a"].Mixin],props:{room:Object},computed:{is_local:function(){return"local"===this.room.id},mousetrap:function(){var e=this;return{cancel:function(){return fo.unselect(e.board)},undo:function(){return e.$store.room.undo(e.room.id)},redo:function(){return e.$store.room.redo(e.room.id)},"i l o v e b e e s":function(){fo.doAction(e.board,["toggleCheat"]),e.$store.room.sync(e.room.id)}}},board:function(){return this.room.board},turn_text:function(){return this.board.local_player?fo.isUsersTurn(this.board)?"Your turn":"Opponent's turn":"Player ".concat(this.board.current_player,"'s turn")},css:function(){var e=this,t=b.a.alert,n=b.a.icon,r=this.board.current_player,o=function(t,n){var o=t===r,a=fo.isUsersTurn(e.board)?"green":"red",c=1===n[n.length-1].length?"":"long";return"player_".concat(t," odd-q ").concat(o?"highlight-"+a:""," ").concat(c)},a=1===r?"left":"right",c="absolute top-0 ".concat(a,"-0 flex");return{alert:t,icon:n,player:o,player_indicator:c}},rows:function(){return yo(this.board,{columns:2})}},mounted:function(){dt.makeSprites();var e=this.$refs.scroll_box,t=e.scrollWidth,n=e.scrollHeight,r=e.clientWidth,o=e.clientHeight;e.scroll((t-r)/2,(n-o)/2)},methods:{click:function(e){fo.click(this.board,e),this.$store.room.sync(this.room.id)},deleteSelected:function(){if(this.is_local){var e=this.board.selected.piece_id;fo.deletePiece(this.board,e)}else this.$ui.toast("TODO: Delete not implemented for network games.")}}};zo.render=Yn;var Do=zo,Jo={components:{Game:Do,NewGame:Dn},__route:{path:"/play/:room_id/",meta:{authRequired:!0},beforeEnter:function(e,t,n){var r=e.params.room_id;"local"!==r&&isNaN(Number(r))?n("/"):n()}},computed:{room_id:function(){var e=this.$route.params.room_id;return"local"===e?e:Number(e)},room:function(){return this.$store.room.watch(this.room_id)}},methods:{setRules:function(e){this.$store.room.send(this.room_id,"set_rules",e)},startGame:function(){this.$store.room.send(this.room_id,"start_game")}}};Jo.render=Wt;var Ko=Jo,Bo={About:mt,Home:qt,ChangeLog:Tt,NewGameRedirect:Ht,OnlineRoom:Ko},Yo=Object(N["a"])(i["a"].routes),Vo=function(e){return Object.entries(e).forEach((function(e){var t=Object(H["a"])(e,2),n=t[0],r=t[1],o={name:n.toLowerCase(),path:"/".concat(n.toLowerCase()),component:r};Object.assign(o,r.__route),Object(M["defaultsDeep"])(o,{meta:{title:n}}),Yo.push(o)}))};Vo(Bo),Vo(dt.views);var Zo=F["b"],Qo=Object(F["a"])({history:Zo(),routes:Yo});Qo.beforeEach(ft),Qo.beforeEach((function(){}));var Xo=Qo,ea={},ta={},na={},ra="local_storage_game",oa=Object(A["c"])(),aa=Object(r["s"])({current_room:null,rooms:{}}),ca=a["a"].ui,ia=function(e){var t=e.store;ta.local={send:function(e){var t=JSON.parse(e),n=t.action,r=t.content,o=aa.rooms.local;"set_rules"===n?o.state.rules=r:"start_game"===n?(delete na.local,o.board=na.local=fo.new({rules:o.state.rules,game_id:"local",rooom_id:"local"}),$.a.set(ra,fo.toJson(o.board))):"change_pieces"===n&&(delete na.local,delete o.board)}};var n=function e(n){if(aa.current_room=n,"local"===n){if(!aa.rooms.local){var r=$.a.get(ra);aa.rooms.local={id:n,state:{rules:r&&r.rules},board:r&&fo.fromJson(r)}}return aa.rooms.local}if(clearTimeout(ea[n]),ta[n])return aa.rooms[n];var a="https:"===window.location.protocol?"wss":"ws",c="".concat(a,"://").concat(window.location.host,"/ws/chat/").concat(n,"/"),i=ta[n]=new WebSocket(c);return i.__ticks=0,i.onclose=function(){var t=aa.rooms[n]||{};delete ta[n],t.disconnected=!0,ea[n]=setTimeout((function(){e(n),t.reconnect_tries=(t.reconnect_tries||0)+1}),5e3)},i.onmessage=function(e){var r=aa.rooms[n]=JSON.parse(e.data);if(404===r.error)return r.state={},void ca.alert({title:"Unable to find room",confirm:function(){return window.location="/"}});if(r.ticks=i.__ticks++,r.game_id&&!na[r.game_id]){var a=na[r.game_id]=fo.new(r.game);a.local_player=parseInt(Object.keys(a.players).find((function(e){return a.players[e]===t.auth.user.id})))}r.board=na[r.game_id],o(n)},aa.rooms[n]},r=function(e,t,n){"reset_game"===t&&(t="start_game"),ta[e].send(JSON.stringify({action:t,content:n}))},o=function(e){var t=aa.rooms[e];if("local"!==e){if(t.game){var n=t.board,o=t.game.actions,a=o.length-n.actions.length;if(a<-1)throw console.error(t.game.actions,n.actions),"Game too far out of sync with server";-1===a&&r(e,"action",{hash:n.hash,action:n.actions[n.actions.length-1],action_count:n.actions.length});while(o.length>n.actions.length)fo.doAction(n,o[n.actions.length])}}else $.a.set(ra,fo.toJson(t.board))},a=function(e,t){var n=aa.rooms[e]||{},r=n.board;r&&("local"===e?fo[t](r):ca.toast("Can only ".concat(t," in local games.")))},c={state:aa,undo:function(e){return a(e,"undo")},redo:function(e){return a(e,"redo")},watch:n,send:r,sync:o,save:function(){return oa.post("/room/")},isHost:function(e){var n,r;return"local"===e||(null===(n=aa.rooms[e])||void 0===n?void 0:n.state.host_id)===(null===(r=t.auth.user)||void 0===r?void 0:r.id)},loadJson:function(e){var t=n("local");try{"string"===typeof e&&(e=JSON.parse(e)),t.board=fo.fromJson(e),t.state.rules=t.board.rules,Xo.push("/play/local"),ca.toast("Local game loaded"),ca.alert(null)}catch(o){var r="An unknown error occurred. Unable to parse game.";ca.alert(r)}}};return c},sa={list:[],install:function(e,t){e.config.globalProperties.$store=sa,sa.list.forEach((function(e){var t;return null===(t=e.init)||void 0===t?void 0:t.call(e)}))}},la={config:P,room:ia};Object.entries(la).forEach((function(e){var t=Object(H["a"])(e,2),n=t[0],r=t[1];sa[n]=r({store:sa}),sa.list.push(sa[n])}));var ua=sa;function pa(e,t,n,o,a,c){var i=Object(r["w"])("Nav"),s=Object(r["w"])("router-view"),l=Object(r["w"])("unrest-ui");return Object(r["q"])(),Object(r["d"])(r["a"],null,[Object(r["g"])(i),Object(r["g"])(s,{class:"router-view ".concat(c.debug?"debug":"")},null,8,["class"]),Object(r["g"])(l)],64)}var da=Object(r["f"])(" Hive! "),ha=Object(r["g"])("div",{class:"ur-dropdown__trigger"},"game",-1),fa=Object(r["g"])("div",{class:"ur-dropdown__trigger"},"config",-1),ba=Object(r["f"])(Object(r["A"])(" ")),ma=Object(r["g"])("div",{class:"ur-dropdown__trigger"},"help",-1);function va(e,t,n,o,a,c){var i=Object(r["w"])("router-link"),s=Object(r["w"])("unrest-dropdown"),l=Object(r["w"])("unrest-form"),u=Object(r["w"])("unrest-auth-menu");return Object(r["q"])(),Object(r["d"])("header",{class:a.css.nav.outer()},[Object(r["g"])("section",{class:a.css.nav.section("left")},[Object(r["g"])(i,{to:"/",class:a.css.nav.brand()},{default:Object(r["F"])((function(){return[da]})),_:1},8,["class"])],2),e.$auth.ready?(Object(r["q"])(),Object(r["d"])("section",{key:0,class:a.css.nav.section("flex items-center")},[c.game_links.length?(Object(r["q"])(),Object(r["d"])(s,{key:0,items:c.game_links,placement:"bottom"},{default:Object(r["F"])((function(){return[ha]})),_:1},8,["items"])):Object(r["e"])("",!0),Object(r["g"])(s,{placement:"bottom"},{content:Object(r["F"])((function(){return[Object(r["g"])("div",{class:"dropdown-menu",onClick:t[1]||(t[1]=Object(r["H"])((function(){}),["stop"]))},[Object(r["g"])(l,e.$store.config.form,{actions:Object(r["F"])((function(){return[ba]})),_:1},16)])]})),default:Object(r["F"])((function(){return[fa]})),_:1}),Object(r["g"])(s,{items:a.help_links,placement:"bottom"},{default:Object(r["F"])((function(){return[ma]})),_:1},8,["items"]),Object(r["g"])(u)],2)):Object(r["e"])("",!0)],2)}var ga=[{to:"/about/",text:"About"},{to:"/change-log/",text:"Change Log"}],ya={data:function(){return{css:b.a,help_links:ga}},computed:{game_links:function(){var e,t=this,n=this.$route.params.room_id,r=function(e){var n=function(){t.$store.room.send(t.$route.params.room_id,e),t.$ui.alert(null)};return t.$ui.alert({title:e[0].toUpperCase()+e.slice(1).replace("_"," "),text:"This action cannot be undone. Are you sure?",actions:[{class:"btn -secondary",text:"Cancel",click:function(){return t.$ui.alert(null)}},{class:"btn -primary",text:"Confirm",click:n}]})},o=[{text:"Reset Game",click:function(){return r("reset_game")}},{text:"Change Pieces",click:function(){return r("change_pieces")}},{text:"Import Game",click:this.showImportModal},{text:"Export Game",click:this.showExportModal},{text:"Undo (ctrl+z)",click:function(){return t.$store.room.undo(n)}},{text:"Redo (ctrl+y)",click:function(){return t.$store.room.redo(n)}}],a=function(e){delete e.click,e.class="disabled"};return this.$store.room.isHost(n)||(a(o[0]),a(o[1])),null!==(e=this.$store.room.state.rooms[n])&&void 0!==e&&e.board||(a(o[3]),a(o[4]),a(o[5])),o}},methods:{showImportModal:function(){this.$ui.alert({tagName:"import-game"})},showExportModal:function(){this.$ui.alert({tagName:"export-game",width:420})}}};ya.render=va;var _a=ya,Oa={name:"App",components:{Nav:_a},computed:{debug:function(){return this.$store.config.state.debug}}};Oa.render=pa;var wa=Oa,ja=Object(r["g"])("p",null," Paste the serialized version of a game to load it. ",-1),ka={class:"modal-footer"};function xa(e,t,n,o,a,c){return Object(r["q"])(),Object(r["d"])("div",null,[ja,Object(r["g"])("div",null,[Object(r["g"])("textarea",{onPaste:t[1]||(t[1]=function(){return c.paste&&c.paste.apply(c,arguments)}),style:{width:"100%"},ref:"textarea"},null,544)]),Object(r["g"])("div",ka,[Object(r["g"])("button",{class:"btn -primary",onClick:t[2]||(t[2]=function(t){return e.$ui.alert()})}," Cancel ")])])}var qa={mounted:function(){this.$refs.textarea.focus()},methods:{paste:function(e){this.$store.room.loadJson(e.clipboardData.getData("text"))}}};qa.render=xa;var Ea=qa,Ca=Object(r["g"])("p",null," The string below represents the current game state. Please use it to report bugs or if you want to reload a previous game. ",-1),Ta=Object(r["f"])(Object(r["A"])(" ")),Ha={class:"modal-footer flex"},Aa=Object(r["g"])("i",{class:"fa fa-clipboard"},null,-1),Ia=Object(r["f"])(" Copy"),Wa=Object(r["g"])("div",{class:"flex-grow"},null,-1);function Pa(e,t,n,o,a,c){var i=Object(r["w"])("unrest-form");return Object(r["q"])(),Object(r["d"])("div",null,[Ca,Object(r["g"])(i,{schema:c.schema,state:a.state},{actions:Object(r["F"])((function(){return[Ta]})),_:1},8,["schema","state"]),Object(r["g"])("textarea",{value:c.game_string,cols:"36",rows:"10"},null,8,["value"]),Object(r["g"])("div",Ha,[Object(r["g"])("button",{class:"btn -primary",onClick:t[1]||(t[1]=function(){return c.copy&&c.copy.apply(c,arguments)})},[Aa,Ia]),Wa,Object(r["g"])("button",{class:"btn -primary",onClick:t[2]||(t[2]=function(t){return e.$emit("close")})}," Close ")])])}var Sa={emits:["close"],data:function(){return{state:{}}},computed:{game_string:function(){var e=this.$route.params.room_id,t=fo.toJson(this.$store.room.state.rooms[e].board);return Object.entries(this.state).forEach((function(e){var n=Object(H["a"])(e,2),r=n[0],o=n[1];o||delete t[r]})),JSON.stringify(t)},schema:function(){return{type:"lazy",actions:!0}}},methods:{copy:function(){navigator.clipboard.writeText(this.game_string)}}};Sa.render=Pa;var $a=Sa;n("adcf");i["a"].configure({AUTH_START:"/",oauth_providers:["twitter","github"],enabled:!1});var Na=Object(r["c"])(wa);Na.component("ImportGame",Ea),Na.component("ExportGame",$a),Na.directive("autoscroll",c),Na.use(Xo),Na.use(ua),Na.use(a["a"].plugin),Na.use(a["a"].ui),Na.use(T),Na.use(o["a"].plugin),Na.use(i["a"].plugin),Na.mount("#app")},adcf:function(e,t,n){}});
//# sourceMappingURL=app.4d6dbe48.js.map